<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> 2FA/MFA/OTP Bypass | 47z!h4Ck </title> <meta name="author" content="47z!Lu7h "> <meta name="description" content=""> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link href="/assets/css/bootstrap-toc.min.css?6f5af0bb9aab25d79b2448143cbeaa88" rel="stylesheet"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://47z1lu7h.github.io/projects/pentesting-web/2025-01-01-2fa-bypass/"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?0afe9f0ae161375728f7bcc5eb5b4ab4"></script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> 47z!h4Ck </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">h0m3 </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">teaching </a> </li> <li class="nav-item "> <a class="nav-link" href="/people/">people </a> </li> <li class="nav-item "> <a class="nav-link" href="/hacking/">hacking </a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">submenus </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/publications/">publications</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/projects/">projects</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/blog/">blog</a> </div> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="row"> <div class="col-sm-3"> <nav id="toc-sidebar" class="sticky-top"></nav> </div> <div class="col-sm-9"> <div class="post"> <header class="post-header"> <h1 class="post-title">2FA/MFA/OTP Bypass</h1> <p class="post-description"></p> </header> <article> <h1 id="2famfaotp-bypass">2FA/MFA/OTP Bypass</h1> <h2 id="enhanced-two-factor-authentication-bypass-techniques"><strong>Enhanced Two-Factor Authentication Bypass Techniques</strong></h2> <h3 id="direct-endpoint-access"><strong>Direct Endpoint Access</strong></h3> <p>To bypass 2FA, access the subsequent endpoint directly, knowing the path is crucial. If unsuccessful, alter the <strong>Referrer header</strong> to mimic navigation from the 2FA verification page.</p> <h3 id="token-reuse"><strong>Token Reuse</strong></h3> <p>Reutilizing previously used tokens for authentication within an account can be effective.</p> <h3 id="utilization-of-unused-tokens"><strong>Utilization of Unused Tokens</strong></h3> <p>Extracting a token from one’s own account to bypass 2FA in another account can be attempted.</p> <h3 id="exposure-of-token"><strong>Exposure of Token</strong></h3> <p>Investigate whether the token is disclosed in a response from the web application.</p> <h3 id="verification-link-exploitation"><strong>Verification Link Exploitation</strong></h3> <p>Using the <strong>email verification link sent upon account creation</strong> can allow profile access without 2FA, as highlighted in a detailed <a href="https://srahulceh.medium.com/behind-the-scenes-of-a-security-bug-the-perils-of-2fa-cookie-generation-496d9519771b" rel="external nofollow noopener" target="_blank">post</a>.</p> <h3 id="session-manipulation"><strong>Session Manipulation</strong></h3> <p>Initiating sessions for both the user’s and a victim’s account, and completing 2FA for the user’s account without proceeding, allows an attempt to access the next step in the victim’s account flow, exploiting backend session management limitations.</p> <h3 id="password-reset-mechanism"><strong>Password Reset Mechanism</strong></h3> <p>Investigating the password reset function, which logs a user into the application post-reset, for its potential to allow multiple resets using the same link is crucial. Logging in with the newly reset credentials might bypass 2FA.</p> <h3 id="oauth-platform-compromise"><strong>OAuth Platform Compromise</strong></h3> <p>Compromising a user’s account on a trusted <strong>OAuth</strong> platform (e.g., Google, Facebook) can offer a route to bypass 2FA.</p> <h3 id="brute-force-attacks"><strong>Brute Force Attacks</strong></h3> <h4 id="rate-limit-absence"><strong>Rate Limit Absence</strong></h4> <p>The lack of a limit on the number of code attempts allows for brute force attacks, though potential silent rate limiting should be considered.</p> <p>Note that even if a rate limit is in place you should try to see if the response is different when the valid OTP is sent. In <a href="https://mokhansec.medium.com/the-2-200-ato-most-bug-hunters-overlooked-by-closing-intruder-too-soon-505f21d56732" rel="external nofollow noopener" target="_blank"><strong>this post</strong></a>, the bug hunter discovered that even if a rate limit is triggered after 20 unsuccessful attempts by responding with 401, if the valid one was sent a 200 response was received.</p> <h4 id="slow-brute-force"><strong>Slow Brute Force</strong></h4> <p>A slow brute force attack is viable where flow rate limits exist without an overarching rate limit.</p> <h4 id="code-resend-limit-reset"><strong>Code Resend Limit Reset</strong></h4> <p>Resending the code resets the rate limit, facilitating continued brute force attempts.</p> <h4 id="client-side-rate-limit-circumvention"><strong>Client-Side Rate Limit Circumvention</strong></h4> <p>A document details techniques for bypassing client-side rate limiting.</p> <h4 id="internal-actions-lack-rate-limit"><strong>Internal Actions Lack Rate Limit</strong></h4> <p>Rate limits may protect login attempts but not internal account actions.</p> <h4 id="sms-code-resend-costs"><strong>SMS Code Resend Costs</strong></h4> <p>Excessive resending of codes via SMS incurs costs to the company, though it does not bypass 2FA.</p> <h4 id="infinite-otp-regeneration"><strong>Infinite OTP Regeneration</strong></h4> <p>Endless OTP generation with simple codes allows brute force by retrying a small set of codes.</p> <h3 id="race-condition-exploitation"><strong>Race Condition Exploitation</strong></h3> <p>Exploiting race conditions for 2FA bypass can be found in a specific document.</p> <h3 id="csrfclickjacking-vulnerabilities"><strong>CSRF/Clickjacking Vulnerabilities</strong></h3> <p>Exploring CSRF or Clickjacking vulnerabilities to disable 2FA is a viable strategy.</p> <h3 id="remember-me-feature-exploits"><strong>“Remember Me” Feature Exploits</strong></h3> <h4 id="predictable-cookie-values"><strong>Predictable Cookie Values</strong></h4> <p>Guessing the “remember me” cookie value can bypass restrictions.</p> <h4 id="ip-address-impersonation"><strong>IP Address Impersonation</strong></h4> <p>Impersonating the victim’s IP address through the <strong>X-Forwarded-For</strong> header can bypass restrictions.</p> <h3 id="utilizing-older-versions"><strong>Utilizing Older Versions</strong></h3> <h4 id="subdomains"><strong>Subdomains</strong></h4> <p>Testing subdomains may use outdated versions lacking 2FA support or contain vulnerable 2FA implementations.</p> <h4 id="api-endpoints"><strong>API Endpoints</strong></h4> <p>Older API versions, indicated by /v*/ directory paths, may be vulnerable to 2FA bypass methods.</p> <h3 id="handling-of-previous-sessions"><strong>Handling of Previous Sessions</strong></h3> <p>Terminating existing sessions upon 2FA activation secures accounts against unauthorized access from compromised sessions.</p> <h3 id="access-control-flaws-with-backup-codes"><strong>Access Control Flaws with Backup Codes</strong></h3> <p>Immediate generation and potential unauthorized retrieval of backup codes upon 2FA activation, especially with CORS misconfigurations/XSS vulnerabilities, poses a risk.</p> <h3 id="information-disclosure-on-2fa-page"><strong>Information Disclosure on 2FA Page</strong></h3> <p>Sensitive information disclosure (e.g., phone number) on the 2FA verification page is a concern.</p> <h3 id="password-reset-disabling-2fa"><strong>Password Reset Disabling 2FA</strong></h3> <p>A process demonstrating a potential bypass method involves account creation, 2FA activation, password reset, and subsequent login without the 2FA requirement.</p> <h3 id="decoy-requests"><strong>Decoy Requests</strong></h3> <p>Utilizing decoy requests to obfuscate brute force attempts or mislead rate limiting mechanisms adds another layer to bypass strategies. Crafting such requests requires a nuanced understanding of the application’s security measures and rate limiting behaviours.</p> <h3 id="otp-construction-errors">OTP Construction errors</h3> <p>In case the OTP is created based on data the user already has or that is sending previous to create the OTP, it’s possible for the user to also generate it and bypass it.</p> <h2 id="references">References</h2> <ul> <li><a href="https://github.com/carlospolop/hacktricks/blob/master/pentesting-web/%22https:/medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35%22/README.md" rel="external nofollow noopener" target="_blank">https://medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35</a></li> <li><a href="https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718" rel="external nofollow noopener" target="_blank">https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718</a></li> <li><a href="https://getpocket.com/read/aM7dap2bTo21bg6fRDAV2c5thng5T48b3f0Pd1geW2u186eafibdXj7aA78Ip116_1d0f6ce59992222b0812b7cab19a4bce" rel="external nofollow noopener" target="_blank">https://getpocket.com/read/aM7dap2bTo21bg6fRDAV2c5thng5T48b3f0Pd1geW2u186eafibdXj7aA78Ip116_1d0f6ce59992222b0812b7cab19a4bce</a></li> </ul> <p>P</p> </article> </div> </div> </div> </div> <footer class="sticky-bottom mt-5" role="contentinfo"> <div class="container"> © Copyright 2025 47z!Lu7h . Love is life. And if you miss love, you miss life. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script defer src="/assets/js/bootstrap-toc.min.js?c82ff4de8b0955d6ff14f5b05eed7eb6"></script> <script src="/assets/js/no_defer.js?2930004b8d7fcd0a8e00fdcfc8fc9f24"></script> <script defer src="/assets/js/common.js?4a129fbf39254905f505c7246e641eaf"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>