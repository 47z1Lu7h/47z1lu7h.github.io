<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Domain/Subdomain takeover | 47z!h4Ck </title> <meta name="author" content="47z!Lu7h "> <meta name="description" content=""> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link href="/assets/css/bootstrap-toc.min.css?6f5af0bb9aab25d79b2448143cbeaa88" rel="stylesheet"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://47z1lu7h.github.io/projects/pentesting-web/2025-01-01-domain-subdomain-takeover/"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?0afe9f0ae161375728f7bcc5eb5b4ab4"></script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> 47z!h4Ck </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">h0m3 </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">teaching </a> </li> <li class="nav-item "> <a class="nav-link" href="/people/">people </a> </li> <li class="nav-item "> <a class="nav-link" href="/hacking/">hacking </a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">submenus </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/publications/">publications</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/projects/">projects</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/blog/">blog</a> </div> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="row"> <div class="col-sm-3"> <nav id="toc-sidebar" class="sticky-top"></nav> </div> <div class="col-sm-9"> <div class="post"> <header class="post-header"> <h1 class="post-title">Domain/Subdomain takeover</h1> <p class="post-description"></p> </header> <article> <h1 id="domainsubdomain-takeover">Domain/Subdomain takeover</h1> <h2 id="domain-takeover">Domain takeover</h2> <p>If you discover some domain (domain.tld) that is <strong>being used by some service inside the scope</strong> but the <strong>company</strong> has <strong>lost</strong> the <strong>ownership</strong> of it, you can try to <strong>register</strong> it (if cheap enough) and let the company know. If this domain is receiving some <strong>sensitive information</strong> like a session cookie via <strong>GET</strong> parameter or in the <strong>Referer</strong> header, this is for sure a <strong>vulnerability</strong>.</p> <h3 id="subdomain-takeover">Subdomain takeover</h3> <p>A subdomain of the company is pointing to a <strong>third-party service with a name not registered</strong>. If you can <strong>create</strong> an <strong>account</strong> in this <strong>third party service</strong> and <strong>register</strong> the <strong>name</strong> being in use, you can perform the subdomain takeover.</p> <p>There are several tools with dictionaries to check for possible takeovers:</p> <ul> <li><a href="https://github.com/EdOverflow/can-i-take-over-xyz" rel="external nofollow noopener" target="_blank">https://github.com/EdOverflow/can-i-take-over-xyz</a></li> <li><a href="https://github.com/blacklanternsecurity/bbot" rel="external nofollow noopener" target="_blank">https://github.com/blacklanternsecurity/bbot</a></li> <li><a href="https://github.com/punk-security/dnsReaper" rel="external nofollow noopener" target="_blank">https://github.com/punk-security/dnsReaper</a></li> <li><a href="https://github.com/haccer/subjack" rel="external nofollow noopener" target="_blank">https://github.com/haccer/subjack</a></li> <li><a href="https://github.com/anshumanbh/tko-subs" rel="external nofollow noopener" target="_blank">https://github.com/anshumanbh/tko-sub</a></li> <li><a href="https://github.com/ArifulProtik/sub-domain-takeover" rel="external nofollow noopener" target="_blank">https://github.com/ArifulProtik/sub-domain-takeover</a></li> <li><a href="https://github.com/SaadAhmedx/Subdomain-Takeover" rel="external nofollow noopener" target="_blank">https://github.com/SaadAhmedx/Subdomain-Takeover</a></li> <li><a href="https://github.com/Ice3man543/SubOver" rel="external nofollow noopener" target="_blank">https://github.com/Ice3man543/SubOver</a></li> <li><a href="https://github.com/antichown/subdomain-takeover" rel="external nofollow noopener" target="_blank">https://github.com/antichown/subdomain-takeover</a></li> <li><a href="https://github.com/musana/mx-takeover" rel="external nofollow noopener" target="_blank">https://github.com/musana/mx-takeover</a></li> <li><a href="https://github.com/PentestPad/subzy" rel="external nofollow noopener" target="_blank">https://github.com/PentestPad/subzy</a></li> <li><a href="https://github.com/Stratus-Security/Subdominator" rel="external nofollow noopener" target="_blank">https://github.com/Stratus-Security/Subdominator</a></li> <li><a href="https://github.com/NImaism/takeit" rel="external nofollow noopener" target="_blank">https://github.com/NImaism/takeit</a></li> </ul> <h3 id="subdomain-takeover-generation-via-dns-wildcard">Subdomain Takeover Generation via DNS Wildcard</h3> <p>When DNS wildcard is used in a domain, any requested subdomain of that domain that doesn’t have a different address explicitly will be <strong>resolved to the same information</strong>. This could be an A ip address, a CNAME…</p> <p>For example, if <code class="language-plaintext highlighter-rouge">*.testing.com</code> is wildcarded to <code class="language-plaintext highlighter-rouge">1.1.1.1</code>. Then, <code class="language-plaintext highlighter-rouge">not-existent.testing.com</code> will be pointing to <code class="language-plaintext highlighter-rouge">1.1.1.1</code>.</p> <p>However, if instead of pointing to an IP address, the sysadmin points it to a <strong>third party service via CNAME</strong>, like a G<strong>ithub subdomain</strong> for example (<code class="language-plaintext highlighter-rouge">sohomdatta1.github.io</code>). An attacker could <strong>create his own third party page</strong> (in Gihub in this case) and say that <code class="language-plaintext highlighter-rouge">something.testing.com</code> is pointing there. Because, the <strong>CNAME wildcard</strong> will agree the attacker will be able to <strong>generate arbitrary subdomains for the domain of the victim pointing to his pages</strong>.</p> <p>You can find an example of this vulnerability in the CTF write-up: <a href="https://ctf.zeyu2001.com/2022/nitectf-2022/undocumented-js-api" rel="external nofollow noopener" target="_blank">https://ctf.zeyu2001.com/2022/nitectf-2022/undocumented-js-api</a></p> <h2 id="exploiting-a-subdomain-takeover">Exploiting a subdomain takeover</h2> <p>Subdomain takeover is essentially DNS spoofing for a specific domain across the internet, allowing attackers to set A records for a domain, leading browsers to display content from the attacker’s server. This <strong>transparency</strong> in browsers makes domains prone to phishing. Attackers may employ <a href="https://en.wikipedia.org/wiki/Typosquatting" rel="external nofollow noopener" target="_blank"><em>typosquatting</em></a> or <a href="https://en.wikipedia.org/wiki/Doppelg%C3%A4nger" rel="external nofollow noopener" target="_blank"><em>Doppelganger domains</em></a> for this purpose. Especially vulnerable are domains where the URL in a phishing email appears legitimate, deceiving users and evading spam filters due to the domain’s inherent trust.</p> <p>Check this <a href="https://0xpatrik.com/subdomain-takeover/" rel="external nofollow noopener" target="_blank">post for further details</a></p> <h3 id="ssl-certificates"><strong>SSL Certificates</strong></h3> <p>SSL certificates, if generated by attackers via services like <a href="https://letsencrypt.org/" rel="external nofollow noopener" target="_blank"><em>Let’s Encrypt</em></a>, add to the legitimacy of these fake domains, making phishing attacks more convincing.</p> <h3 id="cookie-security-and-browser-transparency"><strong>Cookie Security and Browser Transparency</strong></h3> <p>Browser transparency also extends to cookie security, governed by policies like the <a href="https://en.wikipedia.org/wiki/Same-origin_policy" rel="external nofollow noopener" target="_blank">Same-origin policy</a>. Cookies, often used to manage sessions and store login tokens, can be exploited through subdomain takeover. Attackers can <strong>gather session cookies</strong> simply by directing users to a compromised subdomain, endangering user data and privacy.</p> <h3 id="emails-and-subdomain-takeover"><strong>Emails and Subdomain Takeover</strong></h3> <p>Another aspect of subdomain takeover involves email services. Attackers can manipulate <strong>MX records</strong> to receive or send emails from a legitimate subdomain, enhancing the efficacy of phishing attacks.</p> <h3 id="higher-order-risks"><strong>Higher Order Risks</strong></h3> <p>Further risks include <strong>NS record takeover</strong>. If an attacker gains control over one NS record of a domain, they can potentially direct a portion of traffic to a server under their control. This risk is amplified if the attacker sets a high <strong>TTL (Time to Live)</strong> for DNS records, prolonging the duration of the attack.</p> <h3 id="cname-record-vulnerability">CNAME Record Vulnerability</h3> <p>Attackers might exploit unclaimed CNAME records pointing to external services that are no longer used or have been decommissioned. This allows them to create a page under the trusted domain, further facilitating phishing or malware distribution.</p> <h3 id="mitigation-strategies"><strong>Mitigation Strategies</strong></h3> <p>Mitigation strategies include:</p> <ol> <li> <strong>Removing vulnerable DNS records</strong> - This is effective if the subdomain is no longer required.</li> <li> <strong>Claiming the domain name</strong> - Registering the resource with the respective cloud provider or repurchasing an expired domain.</li> <li> <strong>Regular monitoring for vulnerabilities</strong> - Tools like <a href="https://github.com/michenriksen/aquatone" rel="external nofollow noopener" target="_blank">aquatone</a> can help identify susceptible domains. Organizations should also revise their infrastructure management processes, ensuring that DNS record creation is the final step in resource creation and the first step in resource destruction.</li> </ol> <p>For cloud providers, verifying domain ownership is crucial to prevent subdomain takeovers. Some, like <a href="https://about.gitlab.com/2018/02/05/gitlab-pages-custom-domain-validation/" rel="external nofollow noopener" target="_blank">GitLab</a>, have recognized this issue and implemented domain verification mechanisms.</p> <h2 id="references">References</h2> <ul> <li><a href="https://0xpatrik.com/subdomain-takeover/" rel="external nofollow noopener" target="_blank">https://0xpatrik.com/subdomain-takeover/</a></li> <li><a href="https://www.stratussecurity.com/post/subdomain-takeover-guide" rel="external nofollow noopener" target="_blank">https://www.stratussecurity.com/post/subdomain-takeover-guide</a></li> </ul> </article> </div> </div> </div> </div> <footer class="sticky-bottom mt-5" role="contentinfo"> <div class="container"> © Copyright 2025 47z!Lu7h . Love is life. And if you miss love, you miss life. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script defer src="/assets/js/bootstrap-toc.min.js?c82ff4de8b0955d6ff14f5b05eed7eb6"></script> <script src="/assets/js/no_defer.js?2930004b8d7fcd0a8e00fdcfc8fc9f24"></script> <script defer src="/assets/js/common.js?4a129fbf39254905f505c7246e641eaf"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>